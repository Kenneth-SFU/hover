/*      Request ID: feebc606f01cac29681673a9242472f8_1668709566 (09/19/2023 2:34am) (FctBEoAgCEDRG8GRGiMcbCAc1Lx+tPi7/1DcGEddf6CbigK5YV+nNjpkmqK2l7cUZZzCeZNHEorW58AE/Fwl4B4f)      */



/*      Resource ID: e024ea80a488680bcad3fa5500f (calendar.js, minified by uglifyjs) (09/19/2023 2:34am) (A:190424, G:105295, K:105295)      */

if(!Date.prototype.toISOString){(function(){function e(e){if(e<10){return"0"+e}return e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}})()}(function(I,M){var A=window.livewhale||{},z=I("body"),_=I("#lw_cal"),r=A.logged_in&&A.has_ssl?"https:":window.location.protocol,e=r+"//"+window.location.host+livewhale.page,U=I("#lw_cal_js_templates");if(!A.lib)A.lib={};A.lwCalendar={};M.templateSettings={evaluate:/\{\[(.+?)\]\}/g,interpolate:/\{\{(.+?)\}\}/g};var t={getWidgetSyntaxFromArgObject:function(e){var i='<widget type="events_calendar">';e=e||{};I.each(e,function(a,e){if(I.isArray(e)){I.each(e,function(e,t){i+='<arg id="'+a+'">'+t+"</arg>"})}else{i+='<arg id="'+a+'">'+e+"</arg>"}});i+="</widget>";return encodeURIComponent(i)}};function a(){var a={default_view:"day",default_minical_view:"day",month_view_day_limit:4,week_start_offset:0,exclude_view:[],show_view_menu:true,show_sidebar:true,show_dynamic_group_menu:false,show_static_group_menu:false,show_tags:false,show_categories:true,month_view_only:false,webcal_feed_links:true,search_all_events_only:true,enable_search_view:false,search_all_groups:false,ampm_with_dots:false,use_modular_templates:true,hide_local_timezone:A.disable_timezones?true:false,disable_timezone:A.disable_timezones?true:false,sidebar:"default",feed_builder_filters:["category","audience","campus","group","tag"],placeholder:"",enable_home_view:false,thumb_width:80,thumb_height:80,location_char_limit:50,modular:false,feed_base_path:null,tag_mode:"and",host:r+"//"+window.location.hostname,event_view_name:"event",valid_views:["day","week","month","all","home","event","feed_builder","search"]};var e=I.isPlainObject(A.calendar_widget_args)?A.calendar_widget_args:{};var i=M.extend({},a,e);if(i.valid_views!=="event"){i.valid_views.push(i.event_view_name)}if(!M.includes(i.valid_views,i.default_view)){i.default_view="day"}var t=["show_view_menu","show_sidebar","month_view_only","show_static_group_menu","show_dynamic_group_menu","show_tags","show_categories","disable_timezone","webcal_feed_links","hide_local_timezone","search_all_events_only","enable_search_view","search_all_groups","mini_cal_heat_map","enable_home_view","modular","use_modular_templates"];var n=["default_view","sidebar","placeholder","tag_mode"];M.each(n,function(e){var t=i[e];if(I.isArray(t)){if(t.length){i[e]=t[t.length-1]}else{i[e]=typeof a[e]==="string"?a[e]:""}}});var s=function(e){return"false"===e||"False"===e?false:!!e};M.each(t,function(e){if(i[e]&&!M.isBoolean(i[e]))i[e]=s(i[e])});i.month_view_day_limit=parseInt(i.month_view_day_limit,10);if(typeof i.exclude_view==="string")i.exclude_view=[i.exclude_view];if(true===i.month_view_only){i.default_view="month";i.exclude_view=["day","week","all"];i.show_view_menu=i.show_sidebar=false}return i}var C=a();var i=A.lwc_use_pushstate||false;var j=window.history&&window.history.pushState&&i?true:false;var O=!j?"#!":"";var d=window.location.pathname;if(j&&A.page){d=A.page?A.page.substring(0,A.page.lastIndexOf("/")+1):"/"}var $=function(e){this._dt=e};I.extend($.prototype,{format:function(e){return e.replace(this._formatChr,I.proxy(this._formatChrCb,this))},_txt_words:["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],_formatChr:/\\?(.?)/gi,_formatChrCb:function(e,t){return this[e]?this[e]():t},_pad:function(e,t){e=String(e);while(e.length<t){e="0"+e}return e},d:function(){return this._pad(this.j(),2)},D:function(){return this.l().slice(0,3)},j:function(){return this._dt.getDate()},l:function(){return this._txt_words[this.w()]+"day"},N:function(){return this.w()||7},S:function(){var e=this.j(),t=e%10;if(t<=3&&parseInt(e%100/10,10)===1){t=0}return["st","nd","rd"][t-1]||"th"},w:function(){return this._dt.getDay()},z:function(){var e=new Date(this.Y(),this.n()-1,this.j()),t=new Date(this.Y(),0,1);return Math.round((e-t)/864e5)},W:function(){var e=new Date(this.Y(),this.n()-1,this.j()-this.N()+3),t=new Date(e.getFullYear(),0,4);return this._pad(1+Math.round((e-t)/864e5/7),2)},F:function(){return this._txt_words[6+this.n()]},m:function(){return this._pad(this.n(),2)},M:function(){return this.F().slice(0,3)},n:function(){return this._dt.getMonth()+1},t:function(){return new Date(this.Y(),this.n(),0).getDate()},L:function(){var e=this.Y();return e%4===0&e%100!==0|e%400===0},o:function(){var e=this.n(),t=this.W(),a=this.Y();return a+(e===12&&t<9?1:e===1&&t>9?-1:0)},Y:function(){return this._dt.getFullYear()},y:function(){return this.Y().toString().slice(-2)},a:function(){if(C.ampm_with_dots){return this._dt.getHours()>11?" p.m.":" a.m."}else{return this._dt.getHours()>11?"pm":"am"}},A:function(){return this.a().toUpperCase()},q:function(){return this._dt.getHours()>11?" p.m.":" a.m."},B:function(){return""},g:function(){return this.G()%12||12},G:function(){return this._dt.getHours()},h:function(){return this._pad(this.g(),2)},H:function(){return this._pad(this.G(),2)},i:function(){return this._pad(this._dt.getMinutes(),2)},s:function(){return this._pad(this._dt.getSeconds(),2)},u:function(){return this._pad(this._dt.getMilliseconds()*1e3,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var e=new Date(this.Y(),0),t=Date.UTC(this.Y(),0),a=new Date(this.Y(),6),i=Date.UTC(this.Y(),6);return e-t!==a-i?1:0},O:function(){var e=this._dt.getTimezoneOffset(),t=Math.abs(e);return(e>0?"-":"+")+this._pad(Math.floor(t/60)*100+t%60,4)},P:function(){var e=this.O();return e.substr(0,3)+":"+e.substr(3,2)},Z:function(){return-this._dt.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(this._formatChr,this._formatChrCb)},r:function(){return"D, d M Y H:i:s O".replace(this._formatChr,this._formatChrCb)},U:function(){return this._dt._date/1e3|0}});var L=A.lib.LWCDate=function(e,t,a){if(e){t=I.isNumeric(t)?parseInt(t,10):0;this._date=new Date(parseInt(e,10)*1e3+parseInt(t,10)*1e3)}else if(a){this._date=new Date(a.valueOf()-a.getTimezoneOffset()*60*1e3)}this._formatter=new $(this)};L.time_format={us:A.time_format_us,euro:A.time_format_euro};L.date_format={us:A.date_format_us,euro:A.date_format_euro};L.user_format_zone="us";L.setUserFormatZone=function(e){L.user_format_zone=e};L.getUserFormatZone=function(){return L.user_format_zone};L.getUserDateFormat=function(){return L.date_format[L.user_format_zone]?L.date_format[L.user_format_zone]:"m/d/Y"};L.getUserTimeFormat=function(){return L.time_format[L.user_format_zone]?L.time_format[L.user_format_zone]:"g:ia"};I.extend(L.prototype,{month_names_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],getFormattedDate:function(e){return this._formatter.format(e)},getDateObject:function(){return this._date},getTimeString:function(e){var t=e&&L.time_format[e]?L.time_format[e]:L.getUserTimeFormat();return this._formatter.format(t)},getShortDateString:function(e){var t=e&&L.date_format[e]?L.date_format[e]:L.getUserDateFormat();return this._formatter.format(t)},getDateTimeString:function(){return this.month_names_short[this._date.getUTCMonth()]+" "+this._date.getUTCDate()+", "+this.getTimeString()},isDayStart:function(){return 0===this.getHours()&&0===this.getMinutes()},getHours:function(){return this._date.getUTCHours()},getMinutes:function(){return this._date.getUTCMinutes()},getSeconds:function(){return this._date.getUTCSeconds()},getMilliseconds:function(){return this._date.getUTCMilliseconds()},getFullYear:function(){return this._date.getUTCFullYear()},getMonth:function(){return this._date.getUTCMonth()},getDate:function(){return this._date.getUTCDate()},getDay:function(){return this._date.getUTCDay()},getTime:function(){return this._date.getTime()},setTimeToZero:function(){this._date.setUTCHours(0);this._date.setUTCMinutes(0);this._date.setUTCSeconds(0)},setHours:function(e,t,a,i){this._date.setHours(e,t,a,i)},setDate:function(e){this._date.setUTCDate(e)}});var E={makePhoneLinks:function(e){if(!e||typeof e!=="string"){return e}var t=/\b([(]{0,1}[0-9]{3}[)]{0,1}[-\s.]{0,1}[0-9]{3}[-\s.]{0,1}[0-9]{4})\b(?!([^<]*>|<\/a>))/g;return e.replace(t,function(e,t){return'<a href="tel:'+t.replace(/[^\d]/g,"")+'">'+t+"</a>"})},makeMailtoLinks:function(e){if(!e||typeof e!=="string"){return e}return e.replace(/\b([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,})\b/gi,function(e,t){return'<a href="mailto:'+t+'">'+t+"</a>"})},setImageDimensions:function(e,t,a){if(!t&&!a)return;var i=t?"/width/"+t:"";var n=a?"/height/"+a:"";e=e.replace(/\/width\/[\d]+/,i);e=e.replace(/\/height\/[\d]+/,n);e=e.replace(/\/crop\/[\d]+/,"");e=e.replace(/\/src_region\/[\d,]+/,"");return e},formatDate:function(e,t){return t&&e?new L(null,null,e).getFormattedDate(t):""},formatTimestamp:function(e,t,a){var i=""+e;var n=""+t;return a&&i.match(/^[\d]+$/)&&n.match(/^-?[\d]*$/)?new L(e,t).getFormattedDate(a):""}};E.formattedDate=E.formatTimestamp;var n={initUrlChangeHandler:function(){var t=this;I(window).hashchange(function(){var e=window.location.hash;e=e.replace(/^#!?/,"");if(e&&(e===t.getHash()||e.length>2&&e.indexOf("view/")===-1&&e.indexOf("date/")===-1)){return}t.parseHash();t.load(I.noop,true)});if(!this.hashHasBang()){this.addBangToHash()}this.parseHash();this.load(function(){z.trigger("calInit.lwcal",[t])},true)},hashHasBang:function(){return 1===window.location.hash.indexOf("!")?true:false},addBangToHash:function(){var e=window.location.hash;if(e.length>1){window.location.hash="#!"+e.substr(1)}},updateUrl:function(){var e=this.getHash();if(e){window.location.hash="!"+e}},buildUrlArgString:function(){var e=[];var t;for(t in this.vars){var a=[];for(var i in this.vars[t]){a.push(encodeURIComponent(this.vars[t][i]))}e.push(t+"/"+a.join("|"))}e=e.sort(function(e,t){if(e.match(/^view/)){return-1}else if(t.match(/^view/)){return 1}else{if(e<t){return-1}if(e>t){return 1}return 0}});return e.length?e.join("/"):""}};var s={initUrlChangeHandler:function(){var t=this;window.addEventListener("popstate",function(e){t.parseUrl();t.load(I.noop,a)});if(window.location.hash&&!this.getUrlArgString()){this.convertDeprecatedHashBasedUrl()}else{this.parseUrl();var a=true;if(j){var e=this.getUrlArgString();if(e.indexOf("view/")===0){a=false}if(C.event_view_name!=="event"&&e.indexOf("event/")===0){a=false}}this.load(function(){z.trigger("calInit.lwcal",[t])},a)}},convertDeprecatedHashBasedUrl:function(){this.parseHash();var e=this.buildUrlArgString();var t=A.page.substring(0,A.page.lastIndexOf("/")+1);window.location.href=t+e},updateUrl:function(){var e=this.buildUrlArgString();var t=A.page.substring(0,A.page.lastIndexOf("/")+1);if(e!==this.getUrlArgString()){window.history.pushState(null,null,t+e)}},buildUrlArgString:function(){var i=this.getView();var e=i;if(i==="search"){var t=this.getVar("search");if(t.length){e+="/"+t[0]}}if(i===C.event_view_name){var a=this.getVar("event_id");if(a.length){e+="/"+a[0]}}else{var n=[];M.each(this.vars,function(e,t){if(t==="view"||i==="search"&&t==="search"){return true}var a=[];M.each(e,function(e){e=encodeURIComponent(e);e=e.replace("%2F","%252F");a.push(e)});n.push(t+"/"+a.join("|"))});n=n.sort(function(e,t){if(e<t){return-1}if(e>t){return 1}return 0});if(n.length){e+="/"+n.join("/")}}return e}};var u=A.lwCalendar.controller=M.extend({vars:{},qstring:{},data:null,is_today:true,init:function(){var a=this;z.trigger("beforeCalInit.lwcal");this.history=[];this.default_view=C.default_view||"day";this.is_first_load=true;z.on("calLoad.lwcal",function(e){a.is_first_load=false;return true});if(window.self!==window.top){z.addClass("lwc_iframe")}z.on("lw.calendarViewClick",function(e,t){a.setVarsInRelativeUrl(t);if("all"===a.getView()){a.clearVar("date")}a.clearVar("more");a.load();return true});this.initUrlChangeHandler()},getTimezone:function(){var e,t,a,i;if(!this._user_tz&&A.lib.localStore.has()&&localStorage.lwLocalTimezone&&-1!==localStorage.lwLocalTimezone.lastIndexOf("}")){a=JSON.parse(localStorage.lwLocalTimezone);i=(new Date).getTime();if(I.isPlainObject(a)&&a.timestamp&&i-a.timestamp<864e5*5){this._user_tz=a.value}}if(!this._user_tz){e=(new Date).toString();t=e.match(/\(([^)]+)\)$/)||e.match(/([A-Z]+) [\d]{4}$/);this._user_tz="EST";if(I.isArray(t)&&t.length>1){var n=t[1].match(/[A-Z]/g);if(n){this._user_tz=n.join("")}}var s=e.split(" ")[5];if(I.browser.mozilla&&navigator.appVersion.indexOf("Win")!==-1){if(s==="GMT-0700"){this._user_tz="PDT"}if(s==="GMT-0400"){this._user_tz="EDT"}}}return this._user_tz},setTimezone:function(e){var t;this._user_tz=e;if(A.lib.localStore.has()){t={value:e,timestamp:(new Date).getTime()};localStorage.lwLocalTimezone=JSON.stringify(t)}},getVar:function(e){return I.isArray(this.vars[e])?this.vars[e]:[]},getView:function(){return this.getVar("view").length?this.getVar("view")[0]:this.default_view},setDate:function(e,t,a){e=e.toString();t=t.toString();a=a.toString();if(t.length===1)t="0"+t;if(a.length===1)a="0"+a;this.setVar("date",e+t+a)},sanitizeVar:function(e){e=e.replace(/"/g,"");e=I("<p>"+e+"</p>").text().replace(/>/g,"&gt;").replace(/</g,"&lt;");return I.trim(e)},setVar:function(e,t){if(!e||!t)return;if(!I.isArray(t)){t=[t]}this.vars[e]=M.map(t,this.sanitizeVar)},appendVar:function(e,t){if(!I.isArray(this.vars[e]))this.vars[e]=[];this.vars[e].push(this.sanitizeVar(t))},removeVar:function(e,t){if(I.isArray(this.vars[e])){var a=I.inArray(I.trim(t),this.vars[e]);if(-1!==a){this.vars[e].splice(a,1);if(!this.vars[e].length){this.clearVar(e)}}}},clearVar:function(e){delete this.vars[e];if(!this.vars.view){this.setVar("view",this.default_view)}},clearVars:function(a){var i=this;var n={language:true};M.each(this.vars,function(e,t){if(a||!n[t]){delete i.vars[t]}})},getValue:function(e){return I.isArray(this.vars[e])?this.vars[e]:false},load:function(t,e,a){var i=this,n=this.getView();z.trigger("calBeforeChange.lwcal",[i,n]);if(!a){this.history.push(M.clone(this.vars))}if(!e){this.updateUrl()}function s(e){if(!e)e={};z.trigger("calChange.lwcal",[i,n,e]);if(I.isFunction(t))t.apply(i);i.registerGoogleAnalyticsPageView()}if(n==="feed_builder"){s()}else{I.ajax({url:this.getAjaxUrl(),dataType:"json",success:function(e){if(i.getTimezone().length<5&&e.user_tz){i.setTimezone(e.user_tz)}if(e.user_format&&e.user_format!==L.getUserFormatZone()){L.setUserFormatZone(e.user_format)}s(e)}})}},registerGoogleAnalyticsPageView:function(){var e="send",t,a;if(!(window._gaq&&window._gaq.push)&&!(M.isObject(window.ga)&&window.ga.getByName)&&!M.isObject(window.gtag)&&!(typeof A.custom_tracking==="function"))return;if(j){t=window.location.pathname}else{t=C.event_view_name===this.getView()?A.liveurl_dir+"/events/"+this.getVar("event_id")[0]:window.location.pathname+window.location.hash}if(typeof A.custom_tracking==="function"){A.custom_tracking(t);return}if(window.gtag&&!j){window.gtag("event","page_view",{page_title:document.title,page_path:t})}if(window._gaq){window._gaq.push(["_trackPageview",t])}if(window.ga&&window.ga.getAll){a=window.ga.getAll();if(a.length&&a[0].get("name")){e=a[0].get("name")+".send"}window.ga(e,"pageview",t)}},loadEventDetailHref:function(e){var t=e.substr(e.lastIndexOf("/")+1).match(/^\d+/);if(!t)return false;this.clearVars();this.setVar("event_id",t[0]);this.setVar("view","event");this.load();return true},getHash:function(){return this.buildUrlArgString()},getUrlArgString:function(){var e=window.location.pathname,t=A.page.substring(0,A.page.lastIndexOf("/")+1);return e!==A.page&&0===e.indexOf(t)?e.substr(t.length):""},parseUrl:function(){var a=this;var e=this.getUrlArgString();e=e.replace(/\/$/,"");a.clearVars();if(!e){return}var t=e.split("/");var i=t[0].trim();var n=false;if(M.includes(C.valid_views,i)){a.setVar("view",i===C.event_view_name?"event":i);t.shift();if(i===C.event_view_name){n=true;if(t.length&&t[0].match(/^\d+.*/)){a.setVar("event_id",t[0])}}if(i==="search"&&t.length%2===1){a.setVar("search",t[0]);t.shift()}}if(!n&&t.length&&t.length%2===0){M.each(this.parseUrlArgString(t.join("/")),function(e,t){a.setVar(t,e)})}},parseHash:function(){var a=this,e;this.vars={};e=window.location.href.split("#")[1]||"";e=e.replace(/^!/,"");if(!e)return;M.each(this.parseUrlArgString(e),function(e,t){a.setVar(t,e)});return},parseUrlArgString:function(e){var t=typeof e==="string"?e.split("/"):[],a={},i;for(var n=0;n<t.length;n+=2){i=decodeURIComponent(t[n+1]).replace(/</g,"&lt;").replace(/>/g,"&gt;");i=i.replace("%2F","/");a[t[n]]=i.split("|")}return a},setVarsInRelativeUrl:function(e,t){if(!e)return;if(-1!==e.indexOf("#")){e=e.substring(e.indexOf("#")+1);e=e.replace(/^!/,"")}var a=u.parseUrlArgString(e);if(t){u.clearVars()}M.each(a,function(e,t){u.setVar(t,e)})},setVarsWithQueryString:function(e){var t=this.parseQueryString(e);for(var a in t){this.setVar(a,decodeURIComponent(t[a]).split("|"))}},parseQueryString:function(e){var t=e.substr(e.lastIndexOf("?")+1),a=t.split("&"),i={};for(var n=0;n<a.length;n++){var s=a[n].split("=");i[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return i},convertQueryStringAndRefresh:function(){if(!window.location.search)return;this.setVarsWithQueryString(window.location.search);window.location=e+"#!"+this.getHash()},getAjaxQueryString:function(){var e=[],t="";for(var a in this.vars){e.push(a+"="+encodeURIComponent(this.vars[a].join("|")))}if(e.length){t="&"+e.join("&")}if(!M.includes(this.vars,"view")){t+="&view="+this.getView()}t+="&user_tz="+encodeURIComponent(this.getTimezone());t+="&syntax="+this.getWidgetSyntax();return t},getValidYmd:function(e){var t,a;if(!e.match(/^\d{8}$/)){return o.getYmdFromDate(new Date)}else{a=new Date(parseInt(e.substring(0,4),10),parseInt(e.substring(4,6),10),0).getDate();t=parseInt(e.substring(6,8),10);return t>=1&&t<=a?e:e.substring(0,6)+"01"}},getViewTemplateVariables:function(){return x.getTemplateVariables(this.getView())},getEventTemplateVariables:function(){return x.getEventTemplateVariables(this.getView())},getAjaxUrl:function(e){var t=e?M.extend(this.vars,e):this.vars;var i=this;var n=A.liveurl_dir+"/calendar/view/"+this.getView();M.each(t,function(e,t){if("view"===t||"language"===t){return true}var a;if("date"===t){a=i.getValidYmd(e[0])}else if("event_id"===t){a=e[0].replace(/^(\d+)(_draft)*.*/,"$1$2")}else{a=encodeURIComponent(e.join("|"));a=a.replace("%2F","%252F")}n+="/"+t+"/"+a});n+="?user_tz="+encodeURIComponent(this.getTimezone());if(this.getVar("language").length){n+="&language="+encodeURIComponent(this.getVar("language")[0])}var a=this.getEventTemplateVariables();n+="&template_vars="+a.join(",");var s=this.getViewTemplateVariables();if(s.length){var r=[];if(-1!==I.inArray("single_events",s)){r.push("single_events")}if(-1!==I.inArray("repeating_events",s)){r.push("repeating_events")}if(r.length){n+="&show="+encodeURIComponent(r.join(","))}}var l=this.getWidgetSyntax();if(C.search_all_groups&&this.getVar("search").length){l=decodeURIComponent(l);l=l.replace(/<arg id="group">[^<]+<\/arg>/g,"");l=encodeURIComponent(l)}n+="&syntax="+l;return n},back:function(){var a=this;if(this.history.length<=1)return;this.clearVars(true);this.history.pop();M.each(this.history.pop(),function(e,t){M.each(e,function(e){a.appendVar(t,e)})});this.load()},getWidgetSyntax:function(){var e;if(!this.syntax){e=I("#lw_cal .lw_widget_syntax,#lw_cal_body_wrapper .lw_widget_syntax");if(!e.length){this.syntax=t.getWidgetSyntaxFromArgObject(C.widget_args||{})}else{this.syntax=e.attr("title")}}return this.syntax}},j?s:n);var l={month_names:["Jan<span>uary</span>","Feb<span>ruary</span>","Mar<span>ch</span>","Apr<span>il</span>","May","Jun<span>e</span>","Jul<span>y</span>","Aug<span>ust</span>","Sept<span>ember</span>","Oct<span>ober</span>","Nov<span>ember</span>","Dec<span>ember</span>"],month_names_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_names:["Sun<span>day</span>","Mon<span>day</span>","Tue<span>sday</span>","Wed<span>nesday</span>","Thu<span>rsday</span>","Fri<span>day</span>","Sat<span>urday</span>"]};var f={init:function(){var i=this,e=u.getTimezone();var t=M.template(I("#lw_cal_timezone_menu_template",U).html());I("#lw_cal_body").append(t({timezones:A.calendar.timezones}));var a=this.$el=I("#lw_cal_tz",_);var n=this.$content=I(".lw_cal_tz_selector_content",a);var s=this.$sel=n.find(".lw_cal_tz_select");this.$wrapper=null;if(e.match(/[A-Z]{3,5}/)){s.find('option[data-tz-abbrv="'+e+'"]').eq(0).prop("selected",true)}else{s.val(e)}a.find(".lw_submit").on("click",function(e){var t=I("option:selected",s),a=t.val();if(a&&u.getTimezone()!==a){u.setTimezone(a);u.load()}i.close()});a.find(".lw_cancel").on("click",function(e){i.close()});z.trigger("calTzDialogInit.lwcal")},open:function(e){var t=this;if(!this.$el){this.init()}e.hoverbox({position:"top",autoOpen:true,html:this.$el.show(),beforeOpen:function(){z.trigger("click")},close:function(){t.$el.hide().appendTo("body");I(this).hoverbox("destroy")}});this.$wrapper=e},close:function(){this.$wrapper.hoverbox("close")}};var g=function(s){var a=this;var e=Math.floor(Date.now()/1e3);var t=new $(new L(e,A.calendar.default_timezone_offset));var i=M.template(I("#lw_cal_view_selector_template",U).html());I("#lw_cal_view_selector").replaceWith(i({date:t.format("Ymd"),display_date:t.format("F j, Y"),search_view_enabled:C.enable_search_view}));this.$el=I("#lw_cal_view_selector");if(!this.$el.length)return;this.$el.on("click","a",function(e){var t=I(this);if(t.closest("li").hasClass("add_new")){return true}e.preventDefault();z.trigger("lw.calendarViewClick",[I(this).attr("href")]);return true}).removeClass("lw_hidden").show();if(C.exclude_view){if(typeof C.exclude_view==="string")C.exclude_view=[C.exclude_view];if(I.isArray(C.exclude_view)){M.each(C.exclude_view,function(e,t){if(e==="day"){a.$el.find("li.day").remove();a.$el.find("li.today").remove()}else{a.$el.find("li."+e).remove()}})}}this.$add_event_link=this.$el.find("#lw_cal_add_event a");this.add_event_url=this.$add_event_link.attr("href");z.on("calLoad.lwcal",M.bind(function(e,t,a){var i=t.getView();this.$el.find(".active").removeClass("active");var n=!C.enable_home_view&&(!i||"day"===i&&s.getView().is_today)?"today":i;this.$el.find("."+n).addClass("active");this.$add_event_link.attr("href",this.add_event_url);this.$el.find("#lw_cal_events_badge").remove();if(a.event_count){this.$el.find("li.all a").append('<div id="lw_cal_events_badge" class=>'+a.event_count+"</div>")}},this))};var p=function(){var e=M.template(I("#lw_cal_header_template",U).html());I("#lw_cal_header").replaceWith(e());var t=this.$header=I("#lw_cal_header");this.$title=I("#lw_cal_this_day",t);this.$scroll_links=I("#lw_cal_scroll_links",t);this.$date_sel=I("#lw_cal_date_selector");this.scroll_template=M.template(I("#lw_cal_scroll_link_template",U).html());t.on("click",".lw_cal_date_scroll a, #lw_cal_date_selector a",function(e){e.preventDefault();u.setVarsInRelativeUrl(I(this).attr("href"));u.load();return true});z.on("change",".lw_cal_date_picker",function(e){e.preventDefault();var t=I(this).val();if(t){u.setVar("date",t);u.load()}return true});z.on("click","#lw_cal_showing a:not(.lw_cal_clear_filters)",function(e){e.preventDefault();var t=I(this),a=t.attr("class").replace("lw_cal_showing_",""),i=decodeURIComponent(t.attr("href"));if(i.indexOf("/")){i=i.substr(i.lastIndexOf("/")+1)}if(a){u.removeVar(a,i);u.load()}return true});z.on("click",".lw_cal_clear_filters",function(e){e.preventDefault();u.clearVar("categories");u.clearVar("audience");u.clearVar("campus");u.clearVar("tags");u.clearVar("groups");u.clearVar("locations");u.clearVar("search");u.clearVar("date");u.clearVar("end_date");u.clearVar("only_online");if(u.getView()=="search"){u.setVar("view","all")}u.load();return true});z.on("mouseover","#lw_cal_showing a",function(e){I(this).addClass("X");return true});z.on("mouseover","#lw_cal_showing a",function(e){I(this).removeClass("X");return true});z.on("click",".lw_cal_back",function(e){e.preventDefault();if(u.history.length>1){u.back()}else{u.clearVars();u.load()}return false})};p.prototype={setTitle:function(e){this.$title.html(e)},clearScrollLinks:function(){this.$scroll_links.html("")},insertScrollLinks:function(e,t){this.$scroll_links.html(this.scroll_template({prev_date:e,next_date:t}))},show:function(){this.$header.css("visibility","visible")},hide:function(){this.$header.css("visibility","hidden")},showBackLink:function(){this.$scroll_links.html('<a href="" class="lw_cal_back"><span class="lw-icon-2x lw-icon-times-circle"></span><span class="lw_sr_only">Close Event</span></a>')},clearDateSelector:function(){this.$date_sel.html("")},insertDateSelector:function(e){this.$date_sel.html(e)},getTitle:function(){return this.$header.find("h5").text()}};var o=M.extend({},l,{$el:_,$body:I("#lw_cal_body"),$events:I("#lw_cal_events"),is_mobile:I(window).width()<=480?true:false,$subscription_menu:null,event_template:M.template(I("#lw_cal_event_template",U).html()),date_sel_template:M.template(I("#lw_cal_date_selector_template",U).html()),show:function(){this.$events.removeClass("lw_cal_loading");this._cal.getHeader().show()},hide:function(){this.$events.css("visibility","hidden");this._cal.getHeader().hide()},getDateFromTimestamp:function(e,t){return new Date(parseInt(e,10)*1e3+parseInt(t,10)*1e3)},hasDifferentLocalTimezone:function(e){var t=e.tz_abbrv.replace(/^(\w)(\w+)(\w)$/,function(e,t,a,i,n,s){return t+a.replace(/S/g,"D")+i});var a=e.tz_abbrv.replace(/^(\w)(\w+)(\w)$/,function(e,t,a,i,n,s){return t+a.replace(/D/g,"S")+i});return e.user_abbrv!==e.tz_abbrv&&e.user_abbrv!==t&&e.user_abbrv!==a?true:false},getEventTimeRange:function(e,t,a){var i=this.hasDifferentLocalTimezone(e),n=C.hide_local_timezone||a||!i?false:true,s=false,r=false,l="",o,c,h;o=new L(e.ts_start,e.tz_offset);c=e.ts_end?new L(e.ts_end,e.tz2_offset):null;if(o.isDayStart()){s=true}if(c&&(o.getMonth()!==c.getMonth()||o.getDate()!==c.getDate())){r=true}if(e.is_all_day){l="All Day";if(r&&c){l+=' <span class="lw_until">(until ';if(!c.isDayStart()){l+=c.getTimeString(e.tz_format)}if(A.timezone_format==="euro"){l+=" "+c.getDate()+" "+this.month_names[c.getMonth()]+")</span>"}else{l+=" "+this.month_names[c.getMonth()]+" "+c.getDate()+")</span>"}}if(e.time_postfix)l+=' <span class="postfix">'+e.time_postfix+"</span>";return l}l=this.getTimes(o,c,s,r,e.tz_format);if((!t&&!C.hide_local_timezone||i)&&!C.disable_timezone){l+=' <span class="lw_cal_tz_abbrv'+(!n?" tz_editable":"")+'">'+e.tz_abbrv+"</span>"}if(n&&!C.disable_timezone){h=this.getLocalTimeRange({ts_start:e.ts_start,ts_end:e.ts_end,tz_offset:e.user_offset,tz2_offset:e.user_offset,tz_abbrv:e.user_abbrv},e,s,r);l+=' <span class="lw_user_time">('+h+")</span>"}if(e.time_postfix)l+=' <span class="postfix">'+e.time_postfix+"</span>";return l},getEventTimeZone:function(e){var t=this.hasDifferentLocalTimezone(e),a="";if(t){a+='<span class="lw_cal_tz_abbrv">'+e.tz_abbrv+"</span>"}return a},getDateRangeFromTimestamps:function(e,t,a,i){var n=new L(e,a),s;if(t){s=new L(t,i)}return this.getDateRange(n,s)},getDateRange:function(e,t){var a;if(t&&e.getMonth()!==t.getMonth()){if(A.timezone_format==="euro"){a='<span class="lw_date_range">'+'<span class="lw_date">'+e.getDate()+"</span> "+this.month_names_short[e.getMonth()]+'<span class="lw_date_range_separator"> - </span>'+'<span class="lw_date">'+t.getDate()+"</span> "+this.month_names_short[t.getMonth()]+"</span>"}else{a='<span class="lw_date_range">'+this.month_names_short[e.getMonth()]+' <span class="lw_date">'+e.getDate()+"</span>"+'<span class="lw_date_range_separator"> - </span>'+this.month_names_short[t.getMonth()]+' <span class="lw_date">'+t.getDate()+"</span>"+"</span>"}}else if(t&&e.getDate()!==t.getDate()){if(A.timezone_format==="euro"){a='<span class="lw_date_range lw_same_month">'+'<span class="lw_date">'+e.getDate()+"</span> "+this.month_names_short[e.getMonth()]+'<span class="lw_date_range_separator"> - </span>'+'<span class="lw_date">'+t.getDate()+"</span> "+this.month_names_short[t.getMonth()]+"</span>"}else{a='<span class="lw_date_range lw_same_month">'+this.month_names[e.getMonth()]+' <span class="lw_date">'+e.getDate()+" - "+t.getDate()+"</span>"+"</span>"}}else{a=this.month_names[e.getMonth()]+' <span class="lw_date">'+e.getDate()+"</span>"}a+='<span class="lw_year">, '+(t?t.getFullYear():e.getFullYear())+"</span>";return a},getLocalTimeRange:function(e,t,a,i,n){var s=new L(e.ts_start,e.tz_offset),r=new L(t.ts_start,t.tz_offset),l=e.ts_end?new L(e.ts_end,e.tz2_offset):null,o=864e5,c,h;c=this.getTimes(s,l,a,i,null);r.setTimeToZero();s.setTimeToZero();h=(s.getTime()-r.getTime())/o;if(0!==h){c+=" "+(h<0?"-":"+")+Math.abs(h)+" Day";if(Math.abs(h)>1)c+="s"}if(!n&&!C.hide_local_timezone){c+=' <span class="lw_cal_tz_abbrv tz_editable">'+e.tz_abbrv+"</span>"}return c},getTimes:function(e,t,a,i,n){var s;if(a&&t){s='until <span class="lw_end_time">'+t.getTimeString(n)+"</span>";if(i){s+=' <span class="lw_end_date">'+this.month_names[t.getMonth()]+" "+t.getDate()+"</span>"}}else{s='<span class="lw_start_time">'+e.getTimeString(n)+"</span>";if(t){if(0!==t.getHours()||0!==t.getMinutes()){s+=' - <span class="lw_end_time">'+t.getTimeString(n)+"</span> "}if(i){s+=' <span class="lw_start_date">';s+=A.timezone_format==="euro"?e.getDate()+" "+this.month_names[e.getMonth()]:this.month_names[e.getMonth()]+" "+e.getDate();s+="</span>";s+=" - ";s+='<span class="lw_end_date">';s+=A.timezone_format==="euro"?t.getDate()+" "+this.month_names[t.getMonth()]:this.month_names[t.getMonth()]+" "+t.getDate();s+="</span>"}}}return s},getDateFromYmd:function(e){var t=parseInt(e.substr(0,4),10),a=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10);return new Date(t,a-1,i)},getYmdFromDate:function(e){var t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate();t=t.toString();a=a.toString();i=i.toString();if(1===a.length)a="0"+a;if(1===i.length)i="0"+i;return t+a+i},getMonthAndDayFromTimestamp:function(e,t){var a=this.getDateFromTimestamp(e,t);return this.month_names[a.getMonth()]+" "+a.getDate()},getMdYFromDate:function(e){return this.month_names[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()},getFormattedListDate:function(e){var t=this.day_names[e.getDay()]+", "+this.month_names[e.getMonth()]+" "+e.getDate();if(e.getYear()!==(new Date).getYear()){t+=", "+String(e.getYear()+1900)}return t},setViewClass:function(e){this.$el.removeClass(function(e,t){return(t.match(/lw_cal_\w+_view/g)||[]).join(" ")});this.$el.addClass("lw_cal_"+e+"_view");z.removeClass(function(e,t){return(t.match(/lw_cal_view_\w+/g)||[]).join(" ")});z.addClass("lw_cal_view_"+e);if(u.getVar("search").length){z.addClass("lw_cal_view_search")}if(e===C.event_view_name){z.addClass("lw_cal_event_detail")}else{z.removeClass("lw_cal_event_detail")}},getEventTitleLink:function(e){var t="";var a=[];var i;if(e.external_url){i=e.external_url;a.push("external_url")}else if(e.href){i=e.href}if(i){if(e.status===2){a.push("hidden_event")}t='<a href="'+i+'"';if(a.length){t+=' class="'+a.join(" ")+'"'}t+=">"+e.title+"</a>"}else{t=e.title}return t},slugify:function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},getEventUrl:function(e,t){var a;if(j){a=C.event_view_name+"/"+String(e)+"-"+this.slugify(t)}else{a=O+"view/event/event_id/"+e}if(d){a=d+a}return a},addHostToSrcSetFilter:function(e,n){return e.replace(/\bsrcset="([^"]*)"/g,function(e,t){var a=t.split(", ");var i=[];M.each(a,function(e){if(e.length>1&&e.charAt(0)==="/"&&e.charAt(1)!=="/"){i.push(n+e)}else{i.push(e)}});return'srcset="'+i.join(", ")+'"'})},addHostToLinks:function(e,i){return e.replace(/\shref="([^"]*)"/,function(e,t){var a=e;if(0!==t.indexOf("http")&&0!==t.indexOf("//")&&-1===t.indexOf("mailto:")){if(0!==t.indexOf("/")){t="/"+t}a=' href="'+i+t+'"'}return a})},formatEventObject:function(a){var e={location:"",summary:"",href:"",title:""};M.each(e,function(e,t){if(!M.has(a,t)){a[t]=e}});if(!a.external_url&&a.href&&d){a.href=d+a.href}if(M.isArray(a.category_classes)){a.category_classes=a.category_classes.join(" ")}if(M.isArray(a.category_audience_classes)){a.category_audience_classes=a.category_audience_classes.join(" ")}if(M.isArray(a.category_campus_classes)){a.category_campus_classes=a.category_campus_classes.join(" ")}if(M.isArray(a.categories)){var t=M.map(a.categories,function(e){return'<a href="'+O+"all/categories/"+encodeURIComponent(e)+'">'+e+"</a>"});a.category_links=t.join(", ")}if(M.isArray(a.categories_audience)){var i=M.map(a.categories_audience,function(e){return'<a href="'+O+"all/categories/"+encodeURIComponent(e)+'">'+e+"</a>"});a.category_audience_links=i.join(", ")}if(M.isArray(a.categories_campus)){var n=M.map(a.categories_campus,function(e){return'<a href="'+O+"all/categories/"+encodeURIComponent(e)+'">'+e+"</a>"});a.category_campus_links=n.join(", ")}if(I.isArray(a.tag_classes)&&a.tag_classes.length){a.tag_classes=a.tag_classes.join(" ")}if(M.isArray(a.tags)){var s=M.map(a.tags,function(e){return'<a href="'+O+"all/tags/"+encodeURIComponent(e)+'">'+e+"</a>"});a.tag_links=s.join(", ")}a.title_link=this.getEventTitleLink(a);a.date_title=this.getWeekDayAndDateFormatFromTimestamp(a.ts_start,a.tz_offset);var r=new L(a.ts_start,a.tz_offset);a.date_start=r.getShortDateString();a.date_start_day=r.getFormattedDate("d");a.date_start_month=r.getFormattedDate("F");a.date_start_month_short=r.getFormattedDate("M");a.date_start_year=r.getFormattedDate("Y");a.date_start_day_of_week=r.getFormattedDate("l");a.time=this.getEventTimeRange(a);a.time_start=r.getTimeString();a.datetime_start=r.getFormattedDate("o-m-dTH:i");a.timezone=this.getEventTimeZone(a);if(a.ts_end&&a.tz2_offset){var l=new L(a.ts_end,a.tz2_offset);a.date_end=l.getShortDateString();a.date_end_day=l.getFormattedDate("d");a.date_end_month=l.getFormattedDate("F");a.date_end_month_short=l.getFormattedDate("M");a.date_end_year=l.getFormattedDate("Y");a.date_end_day_of_week=l.getFormattedDate("l");a.time_end=l.getTimeString();a.datetime_end=l.getFormattedDate("o-m-dTH:i")}var o=a.is_all_day?"F j":"F j, g:ia";if(a.repeats_start){var c=new L(a.repeats_start,a.tz_offset);a.repeats_start=c.getFormattedDate(o)}else{a.repeats_start=""}if(a.repeats_end){var h=new L(a.repeats_end,a.tz_offset);a.repeats_end=h.getFormattedDate(o)}else{a.repeats_end=""}if(a.image_src){a.thumb_width=C.thumb_width;a.thumb_height=C.thumb_height;a.image_orientation="";if(a.image_width&&a.image_height){a.image_orientation=a.image_width>a.image_height?"horizontal":"vertical"}if(A.lib.hasWebPSupport()){if(0!==a.image_src.indexOf("http")&&0!==a.image_src.indexOf("//")&&a.image_src.match(/\.jpe?g$/i)){a.image_src=a.image_src.replace(/\.jpe?g$/i,".webp")}}}a.ical_download_href="//"+window.location.hostname;a.ical_download_href+=A.liveurl_dir+"/ical/events/id/"+a.id;a.add_to_google=this.getAddToGoogleLink(a);a.add_to_yahoo="";if(a.location&&a.location.length>C.location_char_limit&&a.location.substr(0,1)!="<"){a.location=a.location.substr(0,C.location_char_limit)+"..."}M.extend(a,E);return a},getWeekDayAndDateFormat:function(e){var t=this.getDateFromYmd(e);return this.day_names[t.getDay()]+", "+this.month_names[t.getMonth()]+" "+t.getDate()+"<span>, "+t.getFullYear()+"</span>"},getWeekDayAndDateFormatFromTimestamp:function(e,t){var a=this.getDateFromTimestamp(e,t);return this.day_names[a.getUTCDay()]+", "+this.month_names[a.getUTCMonth()]+" "+a.getUTCDate()+"<span>, "+a.getUTCFullYear()+"</span>"},getICalDate:function(e,t){var a;if(!e)return"";a=new L(e,0);return a.getFormattedDate("Ymd")+"T"+a.getFormattedDate("His")+"Z"},getAddToGoogleLink:function(e){var t="http://www.google.com/calendar/event?action=TEMPLATE&",a=[],i=this.getICalDate(e.ts_start),n,s;if(e.ts_end){n=e.ts_end}else{n=e.is_all_day?e.ts_start+3600*24:e.ts_start+3600}s=this.getICalDate(n);a.push("text="+encodeURIComponent(e.title));a.push("dates="+i+"/"+s);if(e.summary){a.push("details="+encodeURIComponent(A.lib.htmlDecode(e.summary)))}if(e.location){a.push("location="+encodeURIComponent(e.location))}return t+a.join("&")+"&trp=false&sprop=&sprop=name:"},getVariablesInTemplate:function(e){var t=e.match(/{{\s*[\w\d._-]+\s*}}/g);var a=t?t.map(function(e){return e.match(/[\w._-]+/)[0]}):[];var i=e.match(/{\[[^\]]*obj\.[\w\d_-]+[^\[]*\]}/g);var n=i?i.map(function(e){return e.match(/obj\.[\w\d_-]+/)[0]}):[];return a.concat(n)},getTemplateVariables:function(e){var t=[];if("day"===e||"today"===e){t=this.getVariablesInTemplate(I("#lw_cal_day_template",U).html()||"")}else if("week"===e){t=this.getVariablesInTemplate(I("#lw_cal_week_template",U).html()||"")}else if("all"===e){t=this.getVariablesInTemplate(I("#lw_cal_all_template",U).html()||"")}else if("month"===e){t=this.getVariablesInTemplate(I("#lw_cal_month_template",U).html()||"")}return t},getEventTemplateVariables:function(e){var t=[];if("event"===e){t=this.getVariablesInTemplate(I("#lw_cal_event_detail_template",U).html()||"")}else if("week"===e||"all"===e||"day"===e||"today"===e||"home"===e){t=this.getVariablesInTemplate(I("#lw_cal_event_template",U).html()||"")}else if("month"===e){t=this.getVariablesInTemplate(I("#lw_cal_month_event_template",U).html()||"")}t=M.map(t,function(e){return e.replace(/^obj\./,"")});return M.uniq(t)},buildEventList:function(e){var n=this,s="";if(!e||!I.isPlainObject(e)||I.isEmptyObject(e)){return s}if(!this.list_tmpl){this.list_tmpl=M.template(I("#lw_cal_list_template",U).html())}M.each(e,function(e,t){var a="",i=n.getDateFromYmd(t);M.each(e,function(e){a+=n.event_template(n.formatEventObject(e))});s+=n.list_tmpl(M.extend({date:n.getFormattedListDate(i),date_raw:i,year:i.getFullYear(),events:a},E))});return s},getStaticMapImageSrc:function(e,t){var a=livewhale.liveurl_dir+"/places/thumb?url="+encodeURIComponent("http://maps.googleapis.com/maps/api/staticmap?sensor=false&size=320x320"+"&zoom=17&markers=size:small|"+e+","+t);return a},getNoResultsTemplate:function(e){if(!this.no_results_tmpl){var t='<div class="no"><p>No events found.</p></div>';this.no_results_tmpl=M.template(U.find("#lw_cal_no_results_template").html()||t)}return this.no_results_tmpl(e)},getPaginationMenu:function(e,t,a){var i="";var n=Math.ceil(e/t);if(a===n){return false}var s=t;if(a===n-1&&e%t!==0){s=e%t}i=this.getPaginationTemplate({range:a*t+" of "+e,page:String(a+1),more:String(s)});if(e<400&&e-a*t>t){i+=' <a href="#" class="list-button caret-button lw_cal_all">Show All</a>'}return i},getPaginationTemplate:function(e){if(!this.pagination_tmpl){var t='Showing {{ range }} events | <a href="#" class="lw_cal_next">Show {{ more }} more</a>';this.pagination_tmpl=M.template(U.find("#lw_cal_pagination_template").html()||t)}return this.pagination_tmpl(e)},showMore:function(a){var i=this,e;this.$events.css({opacity:.5});this.page++;e=u.getAjaxUrl()+"&page="+this.page;if(a)e+="&show_all=1";I.ajax({url:e,dataType:"json",success:function(e){if(a){i.events=e.events}else{M.each(e.events,function(e,t){if(i.events[t]){i.events[t]=i.events[t].concat(e)}else{i.events[t]=e}})}i.$events.html(i.buildEventList(i.events));if(!a){var t=i.getPaginationMenu(i.count,i.per_page,i.page);if(t){i.$pagination.html(t)}else{i.$pagination.hide()}}else{i.$pagination.hide()}z.trigger("calPaginate.lwcal",[u,e]);i.$events.fadeTo(200,1)}})}});var c=function(){this.feature_tmpl=M.template(I("#lw_cal_feature",U).html());this.feature_top_tmpl=M.template(I("#lw_cal_feature_top",U).html());this.feature_item_tmpl=M.template(I("#lw_cal_feature_item",U).html());_.on("click",".lw_cal_feature_top,.lw_cal_feature_item",function(e){e.preventDefault();if(I(e.target).hasClass("tz_editable"))return true;var t=I(this).find("a").attr("href");u.loadEventDetailHref(t);return true})};c.prototype=I.extend(o,{build:function(e){var t=this,a="",i="",n=u.getView(),s=0,r;if(!e||(!e.top||I.isEmptyObject(e.top))&&(!e.other||!e.other.length)){return""}if(e.top){e.top=this.formatEventObject(e.top);e.top.date_time=n==="week"?this.getMonthAndDayFromTimestamp(e.top.ts_start,e.top.tz_offset)+" ":"";e.top.date_time+=e.top.is_all_day?"All Day":t.getFormattedDateTime(e.top);a=t.feature_top_tmpl(e.top)}if(e.other&&e.other.length){s=e.other.length;for(var l=0;l<s;l++){r=e.other[l];r=this.formatEventObject(r);r.date_time=n==="week"?this.getMonthAndDayFromTimestamp(r.ts_start,r.tz_offset,true)+" ":"";r.date_time+=r.is_all_day?"All Day":t.getFormattedDateTime(r);if(0===l)r.is_first=true;i+=t.feature_item_tmpl(r)}}return this.feature_tmpl({feature_top:a,feature_items:i,sub_feature_count:s})},getFormattedDateTime:function(e){var t=o.getDateFromTimestamp(e.ts_start,e.tz_offset);return o.month_names_short[t.getMonth()]+" "+t.getDate()+" "+o.getEventTimeRange(e)}});var v=new c;var h=A.lwCalendar.FeedBuilderView=function(e){this._cal=e;this.name="feed_builder_view";this.tag_mode="any";this.category_mode="any";var s=this,t=I("#lw_cal_feed_template",U),a=I("#lw_cal_feed_selector_template",U);this.preview_template=M.template(I("#lw_cal_preview_template",U).html());if(!t.length||!a.length)return;this.tmpl=M.template(t.html());this.selector_tmpl=M.template(a.html());this.selected={};this.$events.on("change",".lw_cal_feed_selectors input[type=checkbox]",function(e){var t=I(this),a=t.closest(".lw_cal_feed_selector"),i=a.attr("class").replace(/.*lw_cal_feed_selector_type_([\w_-]+).*/,"$1"),n=t.val();if(typeof s.selected[i]==="undefined"||!M.isArray(s.selected[i])){s.selected[i]=[]}if(t.is(":checked")){s.selected[i].push(n)}else{s.selected[i]=M.without(s.selected[i],n)}s.buildFeed();s.updatePreview()});this.$events.on("keyup",".lw_cal_feed_selectors input[type=text]",function(e){var t=I(this),i=I(this).val().toLowerCase(),a=t.closest(".lw_cal_feed_selector"),n=a.find("ul").children();if(i){n.each(function(){var e=I(this),t=e.find("input"),a=e.text().toLowerCase();if(true===t.prop("checked")||-1!==a.indexOf(i)){e.show()}else{e.hide()}})}else{n.show()}});this.$events.on("click",".lw_filter_mode_toggle a",function(e){e.preventDefault();var t=I(this),a,i,n;if(t.hasClass("selected"))return true;i=t.closest(".lw_filter_mode_toggle");n=i.attr("class").replace(/.*lw_filter_mode_type_(\w+).*/,"$1");a=t.hasClass("lw_any")?"any":"all";if(n==="tag"){s.tag_mode=a}else if(n==="category"){s.category_mode=a}t.addClass("selected").siblings("a").removeClass("selected");s.buildFeed();s.updatePreview();return true})};M.extend(h.prototype,o,{render:function(){var a=this,e=C.feed_builder_filters,i={};if(!M.isArray(e)){return false}if(!this.tmpl||!this.selector_tmpl)return;this.setViewClass("feed_builder");this._cal.getHeader().setTitle("Feed Builder");M.each(e,function(e){var t=a.getSelectorItemByType(e);if(t.length){i[e]=a.selector_tmpl({type:e,items:t})}});this.$events.html(this.tmpl({selectors:i}));this.show();if(!M.isEmpty(this.selected)){this.selected={}}this.$ical_result=this.$events.find("#lw_cal_feed_ical_result");this.$rss_result=this.$events.find("#lw_cal_feed_rss_result");this.$json_result=this.$events.find("#lw_cal_feed_json_result");this.$cms_result=this.$events.find("#lw_cal_feed_cms_result");this.$preview=this.$events.find(".lw_cal_feed_preview");if(x.feed_builder_vars&&!M.isEmpty(x.feed_builder_vars)){this.setFeedToCalendarState()}this.buildFeed();this.updatePreview()},setFeedToCalendarState:function(){var a=this,e=x.feed_builder_vars||{};var t={category:e.categories||[],audience:e.audience||[],campus:e.campus||[],group:e.groups||[],tag:e.tags||[]};M.each(t,function(e,t){M.each(e,function(e){a.$events.find(".lw_cal_feed_selector_type_"+t+' input[type="checkbox"][value="'+e+'"]').each(function(){I(this).trigger("click")})})})},close:function(){x.feed_builder_vars={}},updatePreview:function(){var t=this,e=this.getLink("json",this.selected)+"/max/10",i;var a=I('<div class="lw_spinner"></div>').appendTo(this.$preview);I.getJSON(e,function(e){a.remove();if(e&&e.data){e=e.data}if(e&&e.length){i="<ul>";I.each(e,function(e,t){var a=t.date_time?t.date_time:"All Day";i+="<li>"+t.date+", "+a+'<br/><a href="'+t.url+'">'+t.title+"</a></li>"});i+="</ul>"}else{i="<p>The selected feed does not contain any events.</p>"}t.$preview.html(i)})},getSelectorItemByType:function(e){var t=[];switch(e){case"category":if(M.isArray(A.calendar.categories)){t=M.map(A.calendar.categories,function(e){return{id:e,title:e}})}break;case"audience":if(M.isArray(A.calendar.categories_audience)){t=M.map(A.calendar.categories_audience,function(e){return{id:e,title:e}})}break;case"campus":if(M.isArray(A.calendar.categories_campus)){t=M.map(A.calendar.categories_campus,function(e){return{id:e,title:e}})}break;case"tag":if(M.isArray(A.calendar.tags)){t=M.map(A.calendar.tags,function(e){return{id:e,title:e}})}break;case"group":if(M.isArray(A.calendar.groups)){t=M.map(A.calendar.groups,function(e){return{id:e.fullname,title:e.fullname}})}break}return t},buildFeed:function(){var e=C.feed_base_path?C.feed_base_path:false;this.$ical_result.val(this.getLink("ical",this.selected,e));this.$rss_result.val(this.getLink("rss",this.selected));this.$json_result.val(this.getLink("json",this.selected,e));this.$cms_result.val(this.getLink("cms",this.selected,e))},getLink:function(e,t,a){e=e==="cms"?"json":e;var i=this,n=A.liveurl_dir+"/"+e+"/events";M.each(t,function(e,t){if(t==="category"&&i.category_mode==="any"){n+="/category_mode/any"}if(t==="tag"&&i.tag_mode==="any"){n+="/tag_mode/any"}M.each(e,function(e){n+="/"+t+"/"+encodeURIComponent(e).replace(/'/g,"%27")})});if(a){n=n.replace(A.liveurl_dir+"/"+e+"/events","");n=a+"/"+e+n}else{n=window.location.protocol+"//"+window.location.host+n;if(e==="ical"&&C.webcal_feed_links){n="webcal://"+n.replace(/^https?:\/\//,"")}}return n}});var m=A.lwCalendar.DayView=function(e){this._cal=e;this.name="day_view";this.template=M.template(I("#lw_cal_day_template",U).html());this.is_today=false};M.extend(m.prototype,o,{render:function(e,t,a){var n=this,i="",s="",r="",l="",o;this.is_today=a.is_today;this.setViewClass(this.is_today?"today":"day");this._cal.getHeader().setTitle(a.title);this._cal.getHeader().insertScrollLinks(a.prev_date,a.next_date);this.insertDateSelector(a.date);if(I.isArray(a.events)&&a.events.length){for(o=0;o<a.events.length;o++){i+=this.event_template(this.formatEventObject(a.events[o]))}}else{i=this.getNoResultsTemplate({view:t})}if(I.isArray(a.single_events)&&a.single_events.length){for(o=0;o<a.single_events.length;o++){s+=this.event_template(this.formatEventObject(a.single_events[o]))}}else{s=this.getNoResultsTemplate({view:t})}if(I.isArray(a.repeating_events)&&a.repeating_events.length){for(o=0;o<a.repeating_events.length;o++){r+=this.event_template(this.formatEventObject(a.repeating_events[o]))}}M.each(a.upcoming_events,function(e,t){var a=n.getDateFromYmd(t);l+="<h4>"+n.getFormattedListDate(a)+"</h4>";for(var i=0;i<e.length;i++){l+=n.event_template(n.formatEventObject(e[i]))}});var c=this.getDateFromYmd(a.date);if(a.weather.description){var h=I.trim(a.weather.description);var _=h.indexOf(" ");if(-1!==_){a.weather.description=h.substr(_+1)+", "+h.substring(0,_)}}if(a.weather.location){var d=I.trim(a.weather.location);var u=d.indexOf(",");if(-1!==u){a.weather.location=d.substring(0,u)}}this.$events.html(this.template({feature:v.build(a.features),month:this.month_names_short[c.getMonth()],date:n.getFormattedListDate(c),day:c.getDate(),today_facts:a.today_facts&&typeof a.today_facts==="string"?a.today_facts:"",weather:a.weather.description!==undefined&&a.weather.location!==undefined?a.weather:"",events:i,single_events:s,repeating_events:r,event_count:a.events.length,upcoming_events:l}));this.show()},insertDateSelector:function(e){var t=this.getDateFromYmd(e),a=[],i="",n,s,r;var l={label:"",value:"",selected:false};for(var o=-4;o<5;o++){n=new Date(t.getTime());n.setDate(n.getDate()+o);s=this.getMdYFromDate(n);r=this.getYmdFromDate(n);if(o===0){a.push(M.extend({},l,{label:"Jump to Day",selected:true}));i+='<option selected="selected">Jump to Day</option>'}else{a.push(M.extend({},l,{label:s,value:r}));i+='<option value="'+r+'">'+s+"</option>"}}this._cal.getHeader().insertDateSelector(this.date_sel_template({dates:a,options:i}))}});var w=A.lwCalendar.HomeView=function(e){this._cal=e;this.name="home_view";this.is_today=false;var t=I("#lw_cal_home_template",U);if(t.length){this.template=M.template(t.html())}else{this.template=M.template(I("#lw_cal_day_template",U).html())}var a=I("#lw_cal_home_event_template",U);if(a.length){this.home_event_template=M.template(a.html())}};w.prototype.insertDateSelector=m.prototype.insertDateSelector;M.extend(w.prototype,o,{render:function(e,t,a){var n=this,i="",s=[],r="",l=this.home_event_template||this.event_template;this.is_today=a.is_today;this.setViewClass(t);this._cal.getHeader().setTitle(a.title);this._cal.getHeader().insertScrollLinks(a.prev_date,a.next_date);this.insertDateSelector(a.date);if(I.isPlainObject(a.events)){M.each(a.events,function(e,t){if(I.isArray(e)){s=s.concat(e)}})}else{s=a.events}if(s.length){for(var o=0;o<s.length;o++){i+=l(this.formatEventObject(s[o]))}}else{i=this.getNoResultsTemplate({view:t})}M.each(a.upcoming_events,function(e,t){var a=n.getDateFromYmd(t);r+="<h4>"+n.getFormattedListDate(a)+"</h4>";for(var i=0;i<e.length;i++){r+=l(n.formatEventObject(e[i]))}});var c=this.getDateFromYmd(a.date);this.$events.html(this.template({month:this.month_names_short[c.getMonth()],day:c.getDate(),today_facts:"",weather:"",events:i,upcoming_events:r}));this.show()}});var y=A.lwCalendar.ListView=function(e){var a=this;this._cal=e;this.name="list_view";this.all_tmpl=M.template(I("#lw_cal_all_template",U).html()||"{{ events }}");this.week_tmpl=M.template(I("#lw_cal_week_template",U).html()||"{{ events }}");this.$body.on("click",".lw_cal_pagination > a",function(e){e.preventDefault();var t=I(this).hasClass("lw_cal_all")?true:false;a.showMore(t);return true})};M.extend(y.prototype,o,{render:function(e,t,a){var i=this._cal,n=a.title,s;if(a.date&&a.end_date){n=this.getDateRange(this.getDateFromYmd(a.start_date),this.getDateFromYmd(a.end_date))}this.setViewClass(t);this._cal.getHeader().setTitle(n);if("week"===t){i.getHeader().insertScrollLinks(a.prev_date,a.next_date);this.insertDateSelector(a.start_date)}else{i.getHeader().clearScrollLinks();i.getHeader().clearDateSelector()}var r="week"===t?this.week_tmpl:this.all_tmpl;if(a.events&&!I.isEmptyObject(a.events)||a.single_events&&!I.isEmptyObject(a.single_events)||a.repeating_events&&!I.isEmptyObject(a.repeating_events)){s={events:this.buildEventList(a.events),repeating_events:this.buildEventList(a.repeating_events),single_events:this.buildEventList(a.single_events)}}else{s={events:this.getNoResultsTemplate({view:t}),single_events:this.getNoResultsTemplate({view:t})}}if(a.event_count>a.per_page){this.page=1;this.per_page=a.per_page;this.count=a.event_count;this.events=a.events;this.$pagination=I("<p/>").addClass("lw_cal_pagination pagination-controls");this.$body.append(this.$pagination);var l=this.getPaginationMenu(this.count,this.per_page,this.page);if(l){this.$pagination.html(l)}else{this.$pagination.hide()}}this.$events.html(r(s));this.show()},close:function(e){if(this.$pagination&&this.$pagination.length){delete this.events;this.$pagination.remove();delete this.$pagination}},insertDateSelector:function(e){var a=this,t=[],i="",n=this.getDateFromYmd(e),s,r,l,o;var c=function(e,t){if(e.getMonth()===t.getMonth()){return a.month_names[e.getMonth()]+" "+e.getDate()+"-"+t.getDate()+", "+e.getFullYear()}else{if(e.getFullYear()===t.getFullYear()){return a.month_names[e.getMonth()]+" "+e.getDate()+" - "+a.month_names[t.getMonth()]+" "+t.getDate()+", "+e.getFullYear()}else{return a.month_names[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()+" - "+a.month_names[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()}}};var h={label:"",value:"",selected:false};for(var _=-4;_<=4;_++){if(_===0){t.push(M.extend({},h,{label:"Jump to Week",selected:true}));i+='<option selected="selected">Jump to Week</option>'}else{s=new Date(n.getFullYear(),n.getMonth(),n.getDate()+7*_);r=new Date(s.getFullYear(),s.getMonth(),s.getDate()+6);l=c(s,r);o=this.getYmdFromDate(s);t.push(M.extend({},h,{label:l,value:o}));i+='<option value="'+o+'">'+l+"</option>"}}this._cal.getHeader().insertDateSelector(this.date_sel_template({dates:t,options:i}))}});var b=A.lwCalendar.SearchView=function(e){var a=this;this._cal=e;this.name="search_view";this.tmpl=M.template(I("#lw_cal_search_view_template",U).html()||"{{ events }}");var t=I("#lw_cal_search_event_template",U);if(t.length){this.event_template=M.template(t.html())}this.$body.on("click",".lw_cal_pagination > a",function(e){e.preventDefault();var t=I(this).hasClass("lw_cal_all")?true:false;a.showMore(t);return true});this.addSearchPastEventsCheckbox()};M.extend(b.prototype,o,{render:function(e,t,a){var i=this._cal;var n="Search";this.setViewClass(t);this._cal.getHeader().setTitle(n);i.getHeader().clearScrollLinks();i.getHeader().clearDateSelector();if(a.event_count>a.per_page){this.page=1;this.per_page=a.per_page;this.count=a.event_count;this.events=a.events;this.$pagination=I("<p/>").addClass("lw_cal_pagination pagination-controls");this.$body.append(this.$pagination);var s=this.getPaginationMenu(this.count,this.per_page,this.page);if(s){this.$pagination.html(s)}else{this.$pagination.hide()}}var r=e.getVar("search_past_events").length?true:false;this.$checkbox.show().find("input:checkbox").prop("checked",r);var l=a.events&&!I.isEmptyObject(a.events)?this.buildEventList(a.events):this.getNoResultsTemplate({view:t});this.$events.html(this.tmpl({events:l}));this.show()},addSearchPastEventsCheckbox:function(){var e='<label class="lw_cal_search_past_events">'+'<input type="checkbox"> Include past events'+"</label>";var t=this.$checkbox=I(e).insertAfter(this._cal.$now_showing);t.find("input:checkbox").on("click",function(e){if(I(e.currentTarget).prop("checked")){u.setVar("search_past_events","true")}else{u.clearVar("search_past_events")}u.load()})},close:function(e){var t=this;if(e.getView()!=="search"){e.clearVar("search_past_events");t.$checkbox.hide()}if(this.$pagination&&this.$pagination.length){delete this.events;this.$pagination.remove();delete this.$pagination}}});var k=A.lwCalendar.MonthView=function(e){this._cal=e;this.name="month_view";this.template=M.template(I("#lw_cal_month_template",U).html());this.day_template=M.template(I("#lw_cal_month_day_template",U).html());var t=I("#lw_cal_month_event_template",U);if(t.length){this.event_template=M.template(t.html())}};M.extend(k.prototype,o,{render:function(e,t,a){var i=this,n="<tr>",s=this.day_names.slice(0),r;this.setViewClass(t);this._cal.getHeader().setTitle(a.title);this._cal.getHeader().insertScrollLinks(a.prev_date,a.next_date);this.insertDateSelector(a.date);var l=a.days.length;if(C.week_start_offset>0){for(var o=0;o<C.week_start_offset;o++){r=s.shift();s.push(r)}}M.each(a.days,function(e,t){var a="";if(t!==0&&t+1!==l&&t%7===0){n+="</tr><tr>"}M.each(e.events,function(e,t){e=i.formatEventObject(e);e.time=i.getEventTimeRange(e,true,true);a+=i.event_template(e)});e.events=a;n+=i.day_template(e)});n+="</tr>";this.$events.html(i.template({week_days:"<th>"+s.join("</th><th>")+"</th>",days:n,events:this.buildEventList(a.events),repeating_events:this.buildEventList(a.repeating_events),single_events:this.buildEventList(a.single_events)}));if(M.includes(C.exclude_view,"day")){this.$events.off("click",".lw_cal_date a");this.$events.on("click",".lw_cal_date a",function(){return false})}else{this.hideExcessEvents(a)}this.show()},insertDateSelector:function(e){var t=this.getDateFromYmd(e.substring(0,6)+"01"),a=[],i="",n,s;var r={label:"",value:"",selected:false};for(var l=-6;l<=6;l++){var o=new Date(t.getTime());o.setMonth(o.getMonth()+l);s=this.month_names[o.getMonth()]+" "+o.getFullYear();n=this.getYmdFromDate(o);if(l===0){a.push(M.extend({},r,{label:"Jump to Month",selected:true}));i+='<option selected="selected">Jump to Month</option>'}else{a.push(M.extend({},r,{label:s,value:n}));i+='<option value="'+n+'">'+s+"</option>"}}this._cal.getHeader().insertDateSelector(this.date_sel_template({dates:a,options:i}))},hideExcessEvents:function(l){var o=C.month_view_day_limit||2;this.$events.find("> table > tbody > tr > td").each(function(e,t){var a=I(t),i=a.find(".lw_cal_event"),n=a.find(".lw_cal_date a").attr("href"),s=typeof l.days[e]!=="undefined"?l.days[e].event_count:0,r;if(o<i.length){i.eq(o-1).nextAll().hide()}r=i.filter(":visible");if(s&&s>r.length){a.append(I("<a />",{text:"and "+(s-r.length)+" more...",href:n,"aria-label":"and "+(s-r.length>1?s-r.length+" more events":"1 more event")+" on this day...",class:"lw_cal_show_day"}))}})}});var D=A.lwCalendar.EventView=function(F){var i=this;this._cal=F;this.name="event_view";this.$map=null;this.template=M.template(I("#lw_cal_event_detail_template",U).html());this.$body.on("click",".lw_cal_event_tags a",function(e){e.preventDefault();u.setVar("view","all");u.setVar("tags",I(this).text().toLowerCase());u.load();return false});this.$body.on("click",".lw_cal_event_edit a",function(e){e.preventDefault();var t=u.getVar("event_id")[0],a=encodeURIComponent(i.getEventUrl(t,""));window.location=I(this).attr("href")+"&return_url="+a;return true});this.$events.on("click","#lw_cal_add_to_calendar > a:not(.lw-direct-link)",function(e){e.preventDefault();var t=I(this),a=t.closest("#lw_cal_add_to_calendar").find("ul");e.preventDefault();if(a.is(":visible")){t.removeClass("lw_active")}else{t.addClass("lw_active")}a.slideToggle(200);return true});this.render=function(e,t,a){var i=this;var n;if(a&&a.is_private){document.location.href="/livewhale/?login&url="+window.location.href;return false}if(!a||!a.event||!a.event.title){if(e.history.length>1){e.back()}else{e.clearVars();e.load()}return true}if(A.lib.hasWebPSupport()){if(0!==a.event.image_src.indexOf("http")&&0!==a.event.image_src.indexOf("//")&&a.event.image_src.match(/\.jpe?g$/i)){a.event.image_src=a.event.image_src.replace(/\.jpe?g$/i,".webp")}}if(a.event.url){if(0===a.event.url.indexOf(A.liveurl_dir+"/events/")){n=a.event.url.match(/\/events\/(\d+)/);if(I.isNumeric(n[1])){e.setVar("event_id",n[1]);e.load(null,true,true)}}else{window.location.href=a.event.url}}var s=a.event;if(!j||!e.is_first_load){this.updateMetaData(s)}s.logged_in=A.logged_in;s.date_range="";if(a.event.ts_start){s.date_range=this.getDateRangeFromTimestamps(s.ts_start,s.ts_end,s.tz_offset,s.tz2_offset)}s.date_title=this.getWeekDayAndDateFormatFromTimestamp(s.ts_start,s.tz_offset);var r=new L(s.ts_start,s.tz_offset);s.date_start=r.getShortDateString();s.date_start_day=r.getFormattedDate("d");s.date_start_month=r.getFormattedDate("F");s.date_start_month_short=r.getFormattedDate("M");s.date_start_year=r.getFormattedDate("Y");s.date_start_day_of_week=r.getFormattedDate("l");s.time=this.getEventTimeRange(s);s.time_start=r.getTimeString();s.datetime_start=r.getFormattedDate("o-m-dTH:i");s.timezone=this.getEventTimeZone(s);if(s.ts_end&&s.tz2_offset){var l=new L(s.ts_end,s.tz2_offset);s.date_end=l.getShortDateString();s.date_end_day=l.getFormattedDate("d");s.date_end_month=l.getFormattedDate("F");s.date_end_month_short=l.getFormattedDate("M");s.date_end_year=l.getFormattedDate("Y");s.date_end_day_of_week=l.getFormattedDate("l");s.time_end=l.getTimeString();s.datetime_end=l.getFormattedDate("o-m-dTH:i")}this.setViewClass(t);F.getHeader().setTitle(s.date_range);F.setDocumentTitle(I("<p>"+s.title+"</p>").text());F.getHeader().showBackLink();F.getHeader().clearDateSelector();s.ical_download_href="//"+window.location.hostname;s.ical_download_href+=A.liveurl_dir+"/ical/events/id/"+s.id;s.ical_all_series=s.ical_download_href;s.ical_download_href+="/hide_repeats/true";s.add_to_google=i.getAddToGoogleLink(s);s.add_to_yahoo="";s.date_time=i.getEventDetailTimeRange(s);s.day_of_week=i.getDayOfWeek(s);var o=this.getSaveAndShareLinks(s.title,s.summary,s.image_src,r);var c=I("#lw_cal_event_share_icons",U);if(c.length){var h=M.template(c.html());s.share_links=h(o)}else{s.share_links=this.getDefaultSaveAndShareLinks(o)}if(!M.isEmpty(s.related_content)){var _=I("#lw_cal_event_related_content",U);if(_.length){var d=M.template(_.html());var u="";M.each(s.related_content,function(e){u+=d(e)});s.related_content=u}else{s.related_content=this.getDefaultRelatedContent(s.related_content)}}if(s.search_categories){s.categories=s.search_categories.split("|");var f=M.map(s.categories,function(e){e=I.trim(e);return'<a class="lw_cal_app_link" href="'+O+"view/all/categories/"+encodeURIComponent(e)+'">'+e+"</a>"});s.search_categories=f.join(", ")}if(M.isArray(s.category_classes)){s.category_classes=s.category_classes.join(" ")}if(M.isArray(s.category_audience_classes)){s.category_audience_classes=s.category_audience_classes.join(" ")}if(M.isArray(s.category_campus_classes)){s.category_campus_classes=s.category_campus_classes.join(" ")}if(M.isArray(s.categories)){var g=M.map(s.categories,function(e){return'<a class="lw_cal_app_link" href="'+O+"view/all/categories/"+encodeURIComponent(e)+'">'+e+"</a>"});s.category_links=g.join(", ")}if(M.isArray(s.categories_audience)){var p=M.map(s.categories_audience,function(e){return'<a class="lw_cal_app_link" href="'+O+"view/all/categories/"+encodeURIComponent(e)+'">'+e+"</a>"});s.category_audience_links=p.join(", ")}if(M.isArray(s.categories_campus)){var v=M.map(s.categories_campus,function(e){return'<a class="lw_cal_app_link" href="'+O+"view/all/categories/"+encodeURIComponent(e)+'">'+e+"</a>"});s.category_campus_links=v.join(", ")}if(M.isArray(s.tags_calendar)){s.tags=s.tags_calendar;var m=M.map(s.tags,function(e){return'<a class="lw_cal_app_link" href="'+O+"view/all/tags/"+encodeURIComponent(e)+'">'+e+"</a>"});s.tags_calendar=m.join(", ")}if(M.isArray(s.tags_global_calendar)){s.tags=s.tags_global_calendar;var m=M.map(s.tags,function(e){return'<a class="lw_cal_app_link" href="'+O+"view/all/tags/"+encodeURIComponent(e)+'">'+e+"</a>"});s.tags_global_calendar=m.join(", ")}if(M.isArray(s.tags_starred_calendar)){s.tags=s.tags_starred_calendar;var m=M.map(s.tags,function(e){return'<a class="lw_cal_app_link" href="'+O+"view/all/tags/"+encodeURIComponent(e)+'">'+e+"</a>"});s.tags_starred_calendar=m.join(", ")}if(s.summary&&s.description&&s.summary===s.description){s.summary=""}if(s.image){var w=I("#lw_cal_event_images_template",U);if(w.length){var y=w.html();if(y.match(" src ")){y='<div class="lw_event_image">{{ image }}</div>'}var b=M.template(y)}}this.event_data=s;var k=[];I.each(U.html().match(/{{\s*[\w\d_-]+\s*}}/g),function(e,t){t=I.trim(t.substring(2,t.length-2));k[t]=""});this.$events.html(i.template(M.extend(k,s,E)));if(this.$el.find("#lw_cal_hero").length){this.$el.addClass("lw_cal_has_hero")}this.$events.find(".lw_widget").each(function(e,t){A.lib.initWidget(t)});if(s.location_latitude&&s.location_longitude){var D=this.$events.find(".lw_cal_event_detail_map");var x=D.attr("data-aspect-ratio")?D.attr("data-aspect-ratio"):"1:1";D.lwGoogleMapsEmbed({api_key:livewhale.maps_api_key,latitude:s.location_latitude,longitude:s.location_longitude,aspect_ratio:x})}if(s.has_registration){A.payments.init()}this.show();I(".lw_gallery").each(function(){I(".lw_widget_resources_js").each(function(){A.lib.loadJS(I(this).attr("data-href"))});I(".lw_widget_resources_css").each(function(){A.lib.loadCSS(I(this).attr("data-href"))})});if(typeof gapi!=="object"){this.loadPlusOneJS();var C=setInterval(function(){if(typeof gapi==="object"){gapi.plusone.go(i.$events.get(0));clearInterval(C)}},200)}else{gapi.plusone.go(this.$events.get(0))}if(livewhale.disqus_shortname){window.disqus_shortname=livewhale.disqus_shortname;window.disqus_identifier="lwcal_"+livewhale.disqus_shortname+"_"+s.id;window.disqus_url=window.location.origin+"/live/events/"+s.id;window.disqus_title=s.title+" / "+s.date_range;if(window.DISQUS){window.DISQUS.reset({reload:true})}else{var $=document.createElement("script");$.type="text/javascript";$.async=true;$.src="http://"+livewhale.disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild($)}}var V=I("<div>"+s.description+"</div>");var T=V.find(".lw_widget_metadata");var S=[];if(T.length){I.each(T.find(".lw_widget_resources_js"),function(){if(I.inArray(I(this).attr("data-href"),S)===-1){z.append('<script src="'+I(this).attr("data-href")+'"><\/script>');S[S.length]=I(this).attr("data-href")}});I.each(T.find(".lw_widget_resources_css"),function(){if(I.inArray(I(this).attr("data-href"),S)===-1){z.append('<link rel="stylesheet" type="text/css" href="'+I(this).attr("data-href")+'" />');S[S.length]=I(this).attr("data-href")}});T.remove()}};this.loadPlusOneJS=function(){z.append('<script type="text/javascript" size="small" src="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}<\/script>')};this.close=function(e){if(e.getView()!==C.event_view_name){e.clearVar("event_id")}this.$el.removeClass("lw_cal_has_hero")}};M.extend(D.prototype,o,{updateMetaData:function(e){e=e||{};var t;var a;if(e.ts_start){t=new Date(parseInt(e.ts_start,10)*1e3)}var i=e.summary;if(!i&&e.description){i=e.description.substring(0,128)}var n={title:e.title,type:"event",start_time:t.toISOString(),description:i,url:window.location.href};if(e.ts_end){a=new Date(parseInt(e.ts_end,10)*1e3);n.end_time=a.toISOString()}if(e.images&&e.images.length){var s=e.images[0];n.image=s.src;n["image:width"]=s.width;n["image:height"]=s.height}var r=I("head");r.find('meta[property^="og:"]').remove();M.each(n,function(e,t){if(e){e=I("<p>"+e+"</p>").text();r.append('<meta property="og:'+t+'" content="'+e+'">');if(t==="description"){var a=r.find('meta[name="description"]');if(a.length){a.attr("content",e)}else{r.append('<meta name="description" content="'+e+'">')}}}})},getEventData:function(){return this.event_data},getCalendarEmbedShareLink:function(){var e;e=window.location.protocol+"//"+window.location.hostname;e+=A.liveurl_dir+"/events/calendar-embed/"+u.getVar("event_id")[0];return e},getFacebookShareLink:function(){var e=window.location.href;if(!j){e=this.getCalendarEmbedShareLink()}return"https://www.facebook.com/sharer.php?u="+encodeURIComponent(e)},getTwitterShareLink:function(e,t){var a=window.location.href;var i=this.month_names_short[t.getMonth()]+" "+t.getDate()+", "+e;return"https://twitter.com/intent/tweet?text="+encodeURIComponent(i)+"&url="+encodeURIComponent(a)},getSaveAndShareLinks:function(e,t,a,i){return{facebook:this.getFacebookShareLink(),twitter:this.getTwitterShareLink(e,i)}},getDefaultSaveAndShareLinks:function(n){var s,r;r={twitter:"lw-icon-twitter-square",facebook:"lw-icon-facebook-square",permalink:"lw-icon-link",email:"lw-icon-envelope-o"};s='<div class="lw_widget_saveandshare"><ul>';I.each(["twitter","facebook","email","permalink"],function(e,t){var a=n[t]||"#",i=r[t]||"";s+='<li class="lw_item_'+(e+1)+" "+t+'">'+'<a href="'+a+'" target="_blank" aria-label="Share via '+t+'">'+'<span class="'+i+' lw-icon-2x"></span>'+'<span class="lw_sr_only">'+t+"</span>"+"</a>"+"</li>"});s+="</ul></div>";return s},getDefaultRelatedContent:function(e){if(!M.isArray(e)||!e.length)return"";var t="<ul>";M.each(e,function(e){t+='<li class="lw_related_'+e.type;if(e.doc_type){t+=" "+e.doc_type.toLowerCase()}t+='">';if(e.image_src){t+='<img src="'+e.image_src+'"/>'}t+='<a href="'+e.href+'" target="_blank">'+e.title;if(e.doc_type){t+=" <span>("+e.doc_type+")</span>"}t+="</a>"+"</li>"});t+="</ul>";return t},getEventDetailTimeRange:function(e){var t=e.user_offset&&e.tz_offset!==e.user_offset,a,i,n;a=new L(e.ts_start,e.tz_offset);i=e.ts_end?new L(e.ts_end,e.tz2_offset):null;if(!e.is_all_day&&(i&&(a.getMonth()!==i.getMonth()||a.getDate()!==i.getDate()))){n='<span class="lw_cal_time_range">'+a.getTimeString(e.tz_format)+" to "+i.getTimeString(e.tz_format)+"</span> "+this.getDateRange(a,i);if(!C.disable_timezone&&(!C.hide_local_timezone||t)){n+=' <span class="lw_cal_tz_abbrv">'+e.tz_abbrv+"</span>"}}else{n=this.getEventTimeRange(e)}return n},getDayOfWeek:function(e){var t="",a,i;a=new L(e.ts_start,e.tz_offset);i=e.ts_end?new L(e.ts_end,e.tz2_offset):null;if(!i||a.getMonth()===i.getMonth()&&a.getDate()===i.getDate()){t=this.day_names[a.getDay()]}return t}});var x=A.lwCalendar.calView=M.extend({},o,{init:function(){var r=this,t=I("#lw_cal_sidebar",_),n=true;this.header=new p;if(false!==C.show_view_menu){new g(this)}if(!C.show_sidebar){I("#lw_cal_sidebar").hide()}var e=I("#lw_cal_search");if(e.length){var a=M.template(I("#lw_cal_search_template",U).html());e.replaceWith(a())}var i=I("#lw_cal_subscribe");if(i.length){var s=M.template(I("#lw_cal_subscribe_template",U).html());i.replaceWith(s())}this.showing_template=M.template(I("#lw_cal_showing_template",U).html());this._month_view=null;this._home_view=null;this._day_view=null;this._list_view=null;this._search_view=null;this._event_view=null;this._feed_view=null;this._view=null;this._prev_view=null;this.$now_showing=I("#lw_cal_showing");var l=I('link[rel="canonical"]');if(!l.length){l=I('<link rel="canonical" href="'+document.location.href+'"/>').appendTo(I("head"))}var o="/";var c=document.title||"";if(c.indexOf("|")!==-1){o="|"}else if(c.indexOf("")!==-1){o=""}else if(c.indexOf("")!==-1){o=""}this.title_separator=o;this.page_title=c.indexOf(o)===-1?c:c.substr(c.lastIndexOf(o)+1).trim();z.on("calBeforeChange.lwcal",function(e,t,a,i){r.$events.addClass("lw_cal_loading");if(r._view&&I.isFunction(r._view.close)){r._view.close(t)}if(!C.enable_search_view&&(C.search_all_events_only&&t.getView()!=="all")){t.clearVar("search");t.clearVar("end_date")}});var h=I('head meta[property="og:image"],head meta[name="og:image"]');this.default_og_image=h.length?h.attr("content"):null;if(!C.show_sidebar)this.$el.addClass("no_sidebar");z.on("calChange.lwcal",function(e,t,a,i){r._view=r.getViewObjectFromViewName(a);if(n){_.find(".lw_spinner").remove()}if(r._prev_view&&r._prev_view.name!==r._view){z.trigger("calViewClose.lwcal",[r._prev_view])}r._prev_view=r._view;r._view.render(t,a,i);l.attr("href",window.location.href);if(A.logged_in){r.$events.find(".lw_cal_event").each(function(){var e=I(this),t=e.find(".lw_events_title"),a=e.attr("data-id"),i=encodeURIComponent(r.getEventUrl(e.attr("data-id"),t.text())),n="/livewhale/?events_edit&id="+a+"&return_url="+i,s='<a href="'+n+'" class = "lw_cal_edit_link"><i class="lw-icon-edit lw-icon-fw"></i><span class="lw_sr_only">Edit this event</span></a>';t.append(s)})}r.renderNowShowing(t);if(a!==C.event_view_name){r.setDocumentTitle()}z.trigger("calLoad.lwcal",[t,i]);n=false});this.$events.on("click",".lw_cal_event_list a:not(.lw_cal_edit_link,.lw_cal_location_link,.lw_cal_app_link,.external_url)",r.clickEventHandler);this.$events.on("click",".tz_editable",function(e){e.preventDefault();var t=I(this);if(t.hasClass("lwui-widget"))return true;e.stopPropagation();f.open(t)});z.on("change","#lw_cal_calendar select",function(){var e=I(this).val();if(e){document.location=e}});z.on("calInit.lwcal",function(){var e=u.getVar("groups"),t=I("#lw_cal_calendar select");if(e.length===1&&t.length){t.val(e[0])}});z.on("calLoad.lwcal",function(e,t){var a=parseInt(I("body").css("padding-top"));var i=_.offset().top-a;var n=I(document).scrollTop();var s=I("#lw_page");if(s.length){i=i-parseInt(s.css("margin-top"))}if(n>i){I("html, body").animate({scrollTop:i},250)}if(t.getView()===C.event_view_name){livewhale.frontend.initVideo(r.$events);if(I.lw.accordion){I(".lw_accordion").lw_accordion()}if(I.fn.saveandshare){I(".lw_widget_saveandshare .email a").saveandshare()}r.$events.initFrontendRegion()}return true});if(C.sidebar==="default"){I("#lw_cal_search",t).on("click",function(){t.addClass("lw_cal_sidebar_visible");z.on("click",function(e){if(!I(e.target).closest("#lw_cal_sidebar").length){t.removeClass("lw_cal_sidebar_visible");I(this).off(e)}return true})})}else if(C.sidebar==="original"){t.addClass("lw_cal_sidebar_hidden");_.addClass("lw_cal_original_sidebar");I("#lw_cal_search",t).on("click",function(){if(_.hasClass("lw_cal_month_view")){t.removeClass("lw_cal_sidebar_hidden");z.on("click",function(e){if(!I(e.target).closest("#lw_cal_sidebar").length){t.addClass("lw_cal_sidebar_hidden");I(this).off(e)}return true})}})}this.initEventHandlers();this.initEditDialog()},getViewObjectFromViewName:function(e){var t;switch(e){case"home":t=this.getHomeView();break;case"today":case"day":t=this.getDayView();break;case"all":case"week":t=this.getListView();break;case"search":t=this.getSearchView();break;case"month":t=this.getMonthView();break;case C.event_view_name:t=this.getEventView();break;case"feed_builder":t=this.getFeedBuilderView();break;default:}return t},clickEventHandler:function(e){var t=I(this);var a=t.closest(".lw_cal_event");var i=t.attr("href");var n=t.attr("href");if(d&&n.indexOf(d)===0){n=n.substr(d.length)}n=n.replace(/^(\/?#!?)/,"");var s=n.split("/");if(s&&s[0]!=="view"&&!M.includes(C.valid_views,s[0])){if(!A.lib.hasCurrentDomainAndTld(i)){e.preventDefault();window.open(i)}return true}e.preventDefault();var r;if(j){if(s.length===2){r=s[1]}}else{var l;if(a.length){var o=a.find("a[data-date]");if(o.length){i=o.attr("href");l=o.attr("data-date")}}var c=i.substr(i.lastIndexOf("/")+1).match(/^\d+/);if(c&&c.length===1){r=c[0]}}if(r){u.clearVars();u.setVar("event_id",r);u.setVar("view","event");if(l){u.setVar("date",l)}u.load()}return true},getView:function(){return this._view},getMonthView:function(){if(null===this._month_view){this._month_view=new k(this)}return this._month_view},getHomeView:function(){if(null===this._home_view){this._home_view=new w(this)}return this._home_view},getDayView:function(){if(null===this._day_view){this._day_view=new m(this)}return this._day_view},getListView:function(){if(null===this._list_view){this._list_view=new y(this)}return this._list_view},getSearchView:function(){if(null===this._search_view){this._search_view=new b(this)}return this._search_view},getEventView:function(){if(null===this._event_view){this._event_view=new D(this)}return this._event_view},getFeedBuilderView:function(){if(null===this._feed_view){this._feed_view=new h(this)}return this._feed_view},getDefaultOgImage:function(){return this.default_og_image},getHeader:function(){return this.header},setDocumentTitle:function(e){if(!u.is_first_load||!j){e=e||this.header.getTitle();document.title=(e?e+" "+this.title_separator+" ":"")+this.page_title}},renderNowShowing:function(a){var e=this.showing_template;var t=a.getVar("search").length?a.getVar("search")[0]:"";var i=a.getView()==="all";var n=[];var s=["tags","categories","locations","groups","campus","audience"];M.each(s,function(e){var t=a.getVar(e);if(t.length){n.push({name:e,values:t})}});var r=a.getVar("date");var l,o;if(i&&r.length){l=this.getDateFromYmd(r[0]);var c=a.getVar("end_date");if(c.length){o=this.getDateFromYmd(c[0])}}var h=a.getVar("only_online").length?true:false;if(n.length||t||l||h){this.$now_showing.html(e(I.extend({view:a.getView(),filters:n,search_str:t,only_online:h,start_date:l,end_date:o},E))).show()}else{this.$now_showing.hide()}return true},initEventHandlers:function(){var t=this;this.feed_builder_vars={};z.on("click",".lw_build_feed_from_calendar",function(e){e.preventDefault();t.feed_builder_vars=u.vars;window.location.hash="#view/feed_builder";return true});z.on("click",".lw_cal_app_link",function(e){e.preventDefault();var t=I(this).attr("href");u.setVarsInRelativeUrl(t);u.load();return true});this.initSearchHandlers();if(C.placeholder){I("#lw_cal_search").attr("placeholder",C.placeholder)}this.$events.on("click",".lw_cal_date a",function(e){e.preventDefault();u.setVarsInRelativeUrl(I(this).attr("href"));u.load();return true});this.$events.on("click",".lw_cal_show_day",function(e){e.preventDefault();u.setVarsInRelativeUrl(I(this).attr("href"));u.load();return true});this.$events.on("click","a.lw_cal_show_all_categories",function(e){e.preventDefault();u.vars.categories=[];u.load();return true});this.$events.on("click","a.lw_cal_show_all_calendars",function(e){e.preventDefault();u.vars.calendars=[];u.load();return true});this.$events.on("click","a.lw_cal_show_all_events",function(e){e.preventDefault();u.setVar("view","all");u.load();return true});this.$events.on("click","a.lw_paginate_more, a.lw_paginate_total",function(e){e.preventDefault();if(I(e.target).hasClass("lw_paginate_total")){u.setVar("more","all")}else{var t=u.getVar("more");u.setVar("more",t.length?parseInt(t[0],10)+1:2)}u.load();return true});z.on("click","a.lw_cal_location_link",function(e){e.preventDefault();var t=I(e.currentTarget),a=I(e.target),i=t.attr("data-latitude"),n=t.attr("data-longitude"),s;if(a.hasClass("lwui-widget"))return true;e.stopPropagation();s=I("<div/>").attr("id","lw_cal_location_map");a.hoverbox({position:"left",autoOpen:true,distance:10,html:s,beforeOpen:function(){z.trigger("click")},open:function(){s.lwGoogleMapsEmbed({api_key:livewhale.maps_api_key,latitude:i,longitude:n,zoom:17});s.after('<div class="lw_map_link"><a href="https://www.google.com/maps/place/'+encodeURIComponent(i+","+n)+'" class="lw_skip_link" target="_blank" >Open map in new window</a></div>');I(".lw_map_link").on("click","a",function(e){window.open(I(this).attr("href"),"_blank");return false})},close:function(){I(this).hoverbox("destroy")}});return true})},initSearchHandlers:function(){var i=this;var n=I("#lw_cal_search_form").off("submit").on("submit",function(e){e.preventDefault();var t=n.find('input[type="text"],input[type="search"]');var a=t.val().replace(/>/g,"&gt;").replace(/</g,"&lt;");i.search(a);if(n.find(".lw_skip_link").length==0){n.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>')}return false});z.on("calChange.lwcal",function(e,t){var a=t.getVar("search");var i=a.length?a[0]:"";n.find('input[type="text"],input[type="search"]').val(i)})},search:function(e){if(!e){u.clearVar("search")}u.clearVar("date");u.setVar("search",e);if(C.enable_search_view){u.setVar("view","search")}else if(C.search_all_events_only||u.getView()===C.event_view_name){u.setVar("view","all")}u.load()},initEditDialog:function(){if(!A.logged_in){I(".add_event").hide()}var t;z.on("click",".add_event",function(){if(!t){t=I('<div style="width:400px;"><h3 style="height:35px;">Add Event</h3><form method="post"><div style="height:35px;"><input type="text" name="title" placeholder="Event title"/></div><div style="height:35px;"><input type="text" class="lw_date" name="date" value="" placeholder="Date"/> at <input type="text" class="lw_time" name="time" value="" placeholder="Time"/></div><div><input type="button" name="save" value="Save"/> or <input type="button" name="cancel" value="Cancel"/></div></form></div>').addClass("add_event_overlay").appendTo("body").overlay({autoOpen:false,closeButton:false,destroyOnClose:false});var e=function(e,t){var a=document.createElement("script");a.type="text/javascript";if(a.readyState){a.onreadystatechange=function(){if(a.readyState==="loaded"||a.readyState==="complete"){a.onreadystatechange=null;t()}}}else{a.onload=function(){t()}}a.src=e;document.getElementsByTagName("head")[0].appendChild(a)};e(A.liveurl_dir+"/resource/js/livewhale/thirdparty/jqueryui/jquery-ui.js",function(){e(A.liveurl_dir+"/resource/js/livewhale/scripts/lwui/jquery.lw-timepicker.js",function(){if(!I.browser.msie||I.browser.version>=7){A.lib.initDatepicker(t.find("input.lw_date"));if(I.fn.timepicker){t.find("input.lw_time").timepicker({show24Hours:"euro"===A.timezone_format?true:false,startTime:"8:00am"})}}})});t.on("click",'input[name="cancel"]',function(){t.removeClass("is_open");t.overlay("close")});t.on("click",'input[name="save"]',function(){I.post(A.liveurl_dir+"/events/submit",I(this).parents("form").find(":input").serialize(),function(e){if(e.error){A.prompt("Save Error",e.error,"failure",{Okay:""})}else{t.removeClass("is_open");t.overlay("close");A.prompt("Save Successful","The event was saved successfully.","success",{Okay:""})}},"json")})}if(!t.hasClass("is_open")){t.addClass("is_open");t.overlay("open")}return false})}});var V=A.lwCalendar.subscriptionMenu={init:function(){var n=this,e,t,a,s;var i=this.group=A.group_title||C.group||"";a=I("#lw_cal_subscription_menu_template",U);if(a.length){t=M.template(I("#lw_cal_subscription_menu_template",U).html())}else{t=this.getDefaultTemplate()}if(t&&I.isFunction(t)){e=t({group:i,all_events_link:this.getLink("ical")})}var r=this.$el=I(e);this.$ul=r.find("ul");z.on("calChange.lwcal",function(e,t,a,i){n.refresh()});r.on("click","a[class^=lw_cal_sub]:not(.lw_clipboard)",function(e){window.open(I(this).attr("href"),"_blank");return false});r.on("click",".lw_clipboard",function(e){e.preventDefault();var t=I(this).attr("href"),a,i;if(-1===t.indexOf("http")&&-1===t.indexOf("webcal")){t=C.host+t}a=livewhale.lib.copyToClipboard(t);if(a){i=r.find(".lw_link_copied")}else{i=r.find(".lw_link_copy_failed")}i.css("opacity",1).fadeIn(200);setTimeout(function(){i.animate({opacity:.5},200)},1200);if(s){s.hoverbox("position")}return true});var l=I("#lw_cal_subscribe");if(l.length){var o=l.offset().left+l.width()<I("body").width()/2?"right":"left";s=l.find("a").hoverbox({position:o,close:function(){r.find(".lw_link_copied").hide();r.find(".lw_link_copy_failed").hide()},html:r})}},getLink:function(e,t){var a=I(decodeURIComponent(u.getWidgetSyntax())),n=A.liveurl_dir+"/"+e+"/events",i=["group","exclude_group","tag","exclude_tag","exclude_subscription"],s=["groups","language","tags","audience","campus"],r="";var l={groups:"group",tags:"tag",audience:"categories_audience",campus:"categories_campus"};M.each(i,function(t){a.find("#"+t).each(function(){var e=encodeURIComponent(I(this).text()).replace(/'/g,"%27");if(e){n+="/"+t+"/"+e}})});if(t){n+="/category/"+encodeURIComponent(t)}I.each(s,function(e,t){var a=u.getVar(t);var i=l[t]||t;if("tag"===i&&a.length>1){n+="/tag_mode/any"}M.each(a,function(e){n+="/"+i+"/"+encodeURIComponent(e)})});if(livewhale.feed_suffix){n+=livewhale.feed_suffix}if(t){if(this.group){r=this.group+" "}r+=t+" Events"}else{r=(this.group?this.group:"All")+" Events"}n+="/header/"+encodeURIComponent(r);if(e==="ical"&&C.webcal_feed_links){n=n.replace(/^https?:\/\//,"");n="webcal://"+n}return n},getItem:function(e,t){var a=this.getLink("rss",t),i=this.getLink("ical",t),n;n="<li>"+'<a class="lw_cal_sub_cat" target="new" href="'+a+'" rel="nofollow">'+e+"</a> "+'<a class="lw_cal_sub_rss" target="new" href="'+a+'" rel="nofollow">RSS</a> | '+'<a class="lw_cal_sub_ical" target="new" href="'+i+'" rel="nofollow">ICAL</a> | '+'<a class="lw_cal_sub_ical lw_clipboard" href="'+i+'" rel="nofollow">Copy Link</a>'+"</li>";return n},getCategoryItems:function(){var t=this;var a="";I("#lw_cal_category_selector ul > li > label").each(function(){var e=I.trim(I(this).text());a+=t.getItem(e,e)});return a},refresh:function(){var e=this.getItem("All Calendars"),t=u.getVar("groups"),a,i;if(t&&t.length===1){i=t[0]}else{i=A.group_title||C.group||""}if(i!==this.group){this.group=i;if(i){this.$el.find("> p:first-child strong").text(i)}else{a=this.$el.find("> p:first-child");a.find("strong").text(a.attr("data-default")||"Main Calendar")}}e+=this.getCategoryItems();var n=this.$el.find("a.lw_cal_sub");if(n.length){n.attr("href",this.getLink("ical"))}this.$ul.html(e)},getDefaultTemplate:function(e,t){return'<div id="lw_cal_subscription_menu">'+'<p data-default="Main Calendar">'+"Current calendar: <strong>{{ group }}</strong>"+"</p>"+'<p><a class="lw_cal_sub" href="{{ all_events_link }}">Subscribe to all {{ group }} events</a></p>'+'<p class="lw_link_copied" style="display: none; margin: 10px 0;">'+"Event feed link copied.<br/>Paste into any calendar app."+"</p>"+'<p class="lw_link_copy_fail" style="display: none; margin: 10px 0;">Unable to copy link!</p>'+'<h6 class="" style="margin: 10px 0;">Subscribe by event type:</h6>'+"<ul></ul>"+"</div>"}};var T=M.extend({},o,{init:function(){var e=this.$el=I("#lw_mini_cal");if(!e.length)return;this.year=null;this.month=null;this.$week_sel=I("<div/>").addClass("lw_week_select").hide();this.today=this.getYmdFromDate(new Date);this.sel_tr=null;var s=this;e.on("click","h3 a,.lw_right,.lw_left",function(e){e.preventDefault();var t=I(this);if(t.hasClass("lw_left")){s.previous()}else if(t.hasClass("lw_right")){s.next()}return true});this.$in_focus=null;e.on("keydown","td",function(e){switch(e.which){case 13:e.preventDefault();s.selectDayInFocus();break;case 37:s.prevDayFocus();break;case 39:s.nextDayFocus();break;case 38:e.preventDefault();s.previousWeekFocus();break;case 40:e.preventDefault();s.nextWeekFocus();break}});e.on("click","td",function(e){e.preventDefault();var t=I(this),a=parseInt(t.text(),10),i=s.month,n=s.year;if(!a)return;if(t.hasClass("lw_prev_month")){if(i===1){i=12;n--}else{i--}}if(t.hasClass("lw_next_month")){if(i===12){i=1;n++}else{i++}}I("body").on("calMiniLoad.lwcal",s.focusCurrentDayLink);u.setVar("view",C.default_minical_view);u.clearVar("search");u.clearVar("search_period");u.setDate(n,i,a);u.load()});e.on("click",".lw_week_select",function(e){if(!s.sel_tr)return false;var t=I(s.sel_tr),i;t.children().each(function(e,t){var a=I(t).text();a=a.replace(/>/g,"");if(a){i=parseInt(a,10);return false}});if(i){u.setVar("view","week");u.clearVar("search");u.clearVar("search_period");u.setDate(s.year,s.month,i);u.load()}});e.on("mouseenter","tbody tr",function(e){s.sel_tr=this;var t=I(this).position().top+2;if(I.browser.msie&&parseInt(I.browser.version,10)===8){t+=15}s.$week_sel.show().css("top",t)});e.on("mouseleave","tbody,.lw_week_select",function(e){var t=I(e.toElement||e.relatedTarget);if(t.hasClass("lw_week_select"))return false;s.$week_sel.hide()});e.on("click","table a",function(e){e.preventDefault();return true});z.on("calChange.lwcal",function(e,t,a,i){s.data=i;s.view=a;s.render(null,null,null,a)});this.template=M.template(I("#lw_cal_mini_cal_template",U).html())},selectDayInFocus:function(){this.$in_focus.trigger("click")},removeFocus:function(e){e.attr("aria-selected",false).attr("tabindex",-1).removeClass("lw_focus")},addFocus:function(e){e.attr("aria-selected",true).attr("tabindex",0).addClass("lw_focus").trigger("focus")},prevDayFocus:function(){var e=this.$in_focus;this.removeFocus(e);if(0===e.index()){var t=e.closest("tr");this.$in_focus=0===t.index()?t.siblings(":last").find("td:last"):t.prev().find("td:last")}else{this.$in_focus=e.prev()}this.addFocus(this.$in_focus)},nextDayFocus:function(){var e=this.$in_focus;this.removeFocus(e);if(6===e.index()){var t=e.closest("tr");this.$in_focus=t.closest("tbody").find("tr").length===t.index()+1?t.siblings(":first").find("td:first"):t.next().find("td:first")}else{this.$in_focus=e.next()}this.addFocus(this.$in_focus)},previousWeekFocus:function(){var e=this.$in_focus;this.removeFocus(e);var t=e.closest("tr");this.$in_focus=0===t.index()?t.siblings(":last").find("td").eq(e.index()):t.prev().find("td").eq(e.index());this.addFocus(this.$in_focus)},nextWeekFocus:function(){var e=this.$in_focus;this.removeFocus(e);var t=e.closest("tr");this.$in_focus=t.closest("tbody").find("tr").length===t.index()+1?t.siblings(":first").find("td").eq(e.index()):t.next().find("td").eq(e.index());this.addFocus(this.$in_focus)},focusPreviousMonthLink:function(){I("body").off("calMiniLoad.lwcal",this.focusNextMonthLink);I(".lw_left").trigger("focus")},focusNextMonthLink:function(){I("body").off("calMiniLoad.lwcal",this.focusNextMonthLink);I(".lw_right").trigger("focus")},focusCurrentDayLink:function(){I("body").off("calMiniLoad.lwcal",this.focusCurrentDayLink);I("#lw_mini_cal .selected.active").trigger("focus");if(I("#lw_mini_cal + .lw_skip_link").length==0){I("#lw_mini_cal").after('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>')}},previous:function(){var e,t;if(1===this.month){t=12;e=this.year-1}else{t=this.month-1;e=this.year}I("body").on("calMiniLoad.lwcal",this.focusPreviousMonthLink);this.showMonth(e,t)},next:function(){var e,t;if(12===this.month){t=1;e=this.year+1}else{t=this.month+1;e=this.year}I("body").on("calMiniLoad.lwcal",this.focusNextMonthLink);this.showMonth(e,t)},showMonth:function(t,a){var i=this;var n=u.getVar("view")[0]||"day";if(C.mini_cal_heat_map){var e=A.liveurl_dir+"/calendar/month_events_per_day?year="+t+"&month="+a+u.getAjaxQueryString();I.ajax({url:e,dataType:"json",success:function(e){i.render(t,a,i.day,n,e)}})}else{this.render(t,a,this.day,n)}},getDates:function(){var e,t;var a=u.getVar("date").length?this.getDateFromYmd(u.getVar("date")[0]):new Date;switch(this.view){case"day":case C.event_view_name:e=a;t=e;break;case"week":e=a;t=new Date(e.getFullYear(),e.getMonth(),e.getDate());e.setDate(e.getDate()-e.getDay());t.setDate(e.getDate()+6);break;case"month":e=a;t=new Date(e.getFullYear(),e.getMonth()+1);t.setDate(e.getDate()-1);break;case"all":e=a;if(u.getVar("end_date").length){t=this.getDateFromYmd(u.getVar("end_date")[0])}else{t=new Date;t.setFullYear(5e3)}break;default:e=new Date;t=new Date;break}e.setHours(0,0,0,0);t.setHours(0,0,0,0);return[e,t]},render:function(_,d,e,t,a){var i=this.getDates(),u=i[0],f=i[1],n;if(!_||!d||!e){n=this.getYmdFromDate(u);_=parseInt(n.substr(0,4),10);d=parseInt(n.substr(4,2),10);e=parseInt(n.substr(6,2),10)}var s=d===1?12:d-1,r=d===1?_-1:_,g=this.getDaysInMonth(r,s),p=this.getDaysInMonth(_,d),l=new Date(_,d-1,1),o=l.getDay(),c=Math.ceil((p+o)/7),h=[],v=0-o,m=_.toString()+(d<10?"0"+d:d.toString()),w=this,y=a?a:this.data.month_day_cnt||null;this.year=_;this.month=d;this.day=e;this.sel_tr=null;var b;var k=$.prototype._pad;h=M.map(M.range(c),function(e){var t="",a,i,n;for(var s=0;s<7;s++){v++;n=m+(v<10?"0"+v:v.toString());i=[];if(C.mini_cal_heat_map&&y&&y[v]>0){i.push("has_items")}b=w.getDateFromYmd(_+k(d,2)+k(v,2));if(b.getTime()>=u.getTime()&&b.getTime()<=f.getTime()){i.push("selected")}if(w.today===n){i.push("today")}var r=_;var l=d-1;if(v<=0){i.push("lw_prev_month");a=g+v;if(0===d){l=11;r--}else{l--}}else if(v>p){i.push("lw_next_month");a=v-p;if(11===d){l=0;r++}else{l++}}else{i.push("active");i.push("d_"+v);a=v}var o=new Date(r,l,a);var c=new $(o);var h=c.format("F j, Y");t+='<td class="'+i.join(" ")+'" title="'+h+'" aria-label="'+h+'" role="gridcell" aria-selected="false" tabindex="-1">'+'<a href="#" tabindex="-1">'+a+"</a>"+"</td>"}return t});this.$el.html(this.template({mini_cal_body:"<tr>"+h.join("</tr><tr>")+"</tr>",mini_cal_header:this.month_names[d-1]+" "+_}));if(I("#mini_cal_header").length){I("#mini_cal_header").attr("aria-label",I("#mini_cal_header").text())}var D=this.$el.find("td.selected").first();if(D.length){this.$in_focus=D}else{var x=this.$el.find("tbody td:first");this.$in_focus=x}this.$in_focus.attr("tabindex","0").attr("aria-selected","true").attr("aria-label",this.$in_focus.attr("aria-label")+". Use arrow keys to find a date, Enter to select a date.");this.$el.append(this.$week_sel);z.trigger("calMiniLoad.lwcal",[this,_,d,e])},getDaysInMonth:function(e,t){var a=0===e%4&&e%100||0===e%400?1:0;return t===2?28+a:31-(t-1)%7%2},selectDay:function(e){this.day=e;this.$el.find("td.selected").removeClass("selected");this.$el.find(".d_"+e).addClass("selected")},selectWeek:function(e){this.day=e;this.$el.find("td.selected").removeClass("selected");this.$el.find(".d_"+e).parent("tr").children("td").addClass("selected")}});var S={$el:null,$ul:null,init:function(e){var i=this;this.render();this.$el=I("#"+this.wrapper_id);if(!this.$el.length)return false;this.$ul=this.$("ul").on("click",'input[type="checkbox"]',I.proxy(this.select,this));if(I.isFunction(this.selectorInit())){this.selectorInit()}if(this.$ul.children().length){this.$el.removeClass("lw_hidden").show()}else{this.$el.hide()}z.on("calChange.lwcal",function(e,t,a){i.highlightSelected.apply(i);return true})},$:function(e){return this.$el.find(e)},addItem:function(e){u.appendVar(this.selector_key,e)},removeItem:function(e){u.removeVar(this.selector_key,e)}};var F=A.lwCalendar.tags=M.extend({selector_key:"tags",id_prefix:"lw_cal_tag_",wrapper_id:"lw_cal_tag_selector",visible:false,$ul:null,render:function(){var e,t;if(C.modular&&C.show_tags){e=I("#lw_cal_tag_selector");if(e.length&&A.calendar.tags){t=M.template(I("#lw_cal_tag_selector_template",U).html());e.replaceWith(t({tags:A.calendar.tags}))}}},selectorInit:function(){var t=this;this.$ul=this.$("ul");this.$toggle=this.$("#lw_cal_tag_toggle");this.$toggle.on("click",function(e){e.preventDefault();t.toggleVisibility();t.visible=true;return false});this.$ul.hide();if(window.location.hash.indexOf("tags/")!==-1){this.toggleVisibility()}},toggleVisibility:function(){if("show"===this.$toggle.text()){this.$toggle.text("hide").attr("aria-expanded",true)}else{this.$toggle.text("show").attr("aria-expanded",false)}this.$ul.slideToggle("medium")},select:function(e){if(!I(e.target).is("input[type=checkbox],label")){return true}var t=I(e.currentTarget).closest("li"),a=I.trim(t.find("label").text());if(t.hasClass("selected")){t.removeClass("selected");this.removeItem(a)}else{t.addClass("selected");this.addItem(a)}I(".lw_cal_tag .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(u.getView()===C.event_view_name){u.setVar("view","all");u.clearVar("event_id")}z.trigger("lw.tagUpdated");u.load();return true},highlightSelected:function(){var i=u.getValue(this.selector_key);if(i&&i.length){this.$ul.children().each(function(e,t){var a=I(t);if(I.isArray(i)&&-1!==I.inArray(I.trim(a.find("label").text()),i)){a.addClass("selected").find("input:checkbox").prop("checked",true)}else if(a.hasClass("selected")){a.removeClass("selected").find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false)}return true}},S);var Y=A.lwCalendar.categories=M.extend({selector_key:"categories",id_prefix:"lw_cal_cat_",wrapper_id:"lw_cal_category_selector",render:function(){var e,t;if(C.modular&&C.show_categories){e=I("#lw_cal_category_selector");if(e.length&&A.calendar.categories){t=M.template(I("#lw_cal_category_selector_template",U).html());e.replaceWith(t({categories:A.calendar.categories}))}}},selectorInit:function(){if(C.exclusive_categories){I("<li/>").addClass("all").text("All").prependTo(this.$ul)}},select:function(e){if(C.exclusive_categories){this.select=this.selectCategory}else{this.select=this.toggleCategory}return this.select(e)},toggleCategory:function(e){var t=I(e.currentTarget).closest("li");if(!I(e.target).is("input[type=checkbox]")){return true}if(t.hasClass("selected")){this.deselectItem(t)}else{this.selectItem(t)}I(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(u.getView()===C.event_view_name){u.setVar("view","all");u.clearVar("event_id")}u.load();return true},selectCategory:function(e){var t=I(e.currentTarget).closest("li"),a=u.getView();if(!I(e.target).is("input[type=checkbox]")){return true}if(t.hasClass("selected"))return true;I(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');u.clearVar("categories");u.clearVar("group");if("all"===a){u.setVar("view","day");u.clearVar("tags");u.clearVar("locations");u.clearVar("search");u.clearVar("search_period")}if(a===C.event_view_name){u.setVar("view","day");u.clearVar("event_id")}if(!t.hasClass("all")){this.selectItem(t)}u.load();return true},selectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.addItem(a)},deselectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.removeItem(a)},highlightSelected:function(){var i=u.getValue(this.selector_key);if(i&&i.length){this.$ul.children().each(function(e,t){var a=I(t);if(I.isArray(i)&&-1!==I.inArray(I.trim(a.find("label").text()),i)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}else if(a.hasClass("selected")){a.removeClass("selected");a.find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false);if(C.exclusive_categories){this.$ul.children(".all").addClass("selected")}}return true}},S);var R=A.lwCalendar.audience=M.extend({selector_key:"audience",id_prefix:"lw_cal_cat_audience_",wrapper_id:"lw_cal_category_audience_selector",render:function(){var e,t;if(C.modular&&C.show_categories){e=I("#lw_cal_category_audience_selector");if(e.length&&A.calendar.categories){t=M.template(I("#lw_cal_category_audience_selector_template",U).html());e.replaceWith(t({audiences:A.calendar.categories_audience}))}}},selectorInit:function(){if(C.exclusive_categories){I("<li/>").addClass("all").text("All").prependTo(this.$ul)}},select:function(e){var t=I(e.currentTarget).closest("li");if(!I(e.target).is("input[type=checkbox]")){return true}if(t.hasClass("selected")){this.deselectItem(t)}else{this.selectItem(t)}I(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(u.getView()===C.event_view_name){u.setVar("view","all");u.clearVar("event_id")}u.load();return true},selectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.addItem(a)},deselectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.removeItem(a)},highlightSelected:function(){var i=u.getValue(this.selector_key);if(i&&i.length){this.$ul.children().each(function(e,t){var a=I(t);if(I.isArray(i)&&-1!==I.inArray(I.trim(a.find("label").text()),i)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}else if(a.hasClass("selected")){a.removeClass("selected");a.find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false);if(C.exclusive_categories){this.$ul.children(".all").addClass("selected")}}return true}},S);var H=A.lwCalendar.campus=M.extend({selector_key:"campus",id_prefix:"lw_cal_cat_campus_",wrapper_id:"lw_cal_category_campus_selector",render:function(){var e=I("#lw_cal_category_campus_selector");var t;if(e.length&&A.calendar.categories_campus){t=M.template(I("#lw_cal_category_campus_selector_template",U).html());e.replaceWith(t({campuses:A.calendar.categories_campus}))}},selectorInit:function(){if(C.exclusive_categories){I("<li/>").addClass("all").text("All").prependTo(this.$ul)}},select:function(e){var t=I(e.currentTarget).closest("li");if(!I(e.target).is("input[type=checkbox]")){return true}if(t.hasClass("selected")){this.deselectItem(t)}else{this.selectItem(t)}I(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(u.getView()===C.event_view_name){u.setVar("view","all");u.clearVar("event_id")}u.load();return true},selectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.addItem(a)},deselectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.removeItem(a)},highlightSelected:function(){var i=u.getValue(this.selector_key);if(i&&i.length){this.$ul.children().each(function(e,t){var a=I(t);if(I.isArray(i)&&-1!==I.inArray(I.trim(a.find("label").text()),i)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}else if(a.hasClass("selected")){a.removeClass("selected");a.find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false);if(C.exclusive_categories){this.$ul.children(".all").addClass("selected")}}return true}},S);var W=A.lwCalendar.locations=M.extend({selector_key:"locations",id_prefix:"lw_cal_loc_",wrapper_id:"lw_cal_location_selector",render:function(){var e,t;if(C.modular&&C.show_locations){e=I("#"+this.wrapper_id);if(e.length&&A.calendar.locations){t=M.template(I("#"+this.wrapper_id+"_template",U).html());e.replaceWith(t({locations:A.calendar.locations}))}}},selectorInit:function(){this.locations={};if(M.isArray(A.calendar.locations)&&A.calendar.locations.length){this.locations=M.reduce(A.calendar.locations,function(e,t){e[t.id]=t.title;return e},{})}if(C.exclusive_categories){I("<li/>").addClass("all").text("All").prependTo(this.$ul)}},getLocation:function(e){return this.locations[e]},select:function(e){if(!I(e.target).is("input[type=checkbox]")){return true}var t=I(e.currentTarget).closest("li"),a=t.find("input").val();if(t.hasClass("selected")){t.removeClass("selected");this.removeItem(a)}else{t.addClass("selected");this.addItem(a)}I(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(u.getView()===C.event_view_name){u.setVar("view","all");u.clearVar("event_id")}u.load();return true},highlightSelected:function(){var n=u.getValue(this.selector_key);if(n&&n.length){this.$ul.children().each(function(e,t){var a=I(t),i=a.find("input").val();if(I.isArray(n)&&-1!==I.inArray(i,n)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}else if(a.hasClass("selected")){a.removeClass("selected");a.find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false)}return true}},S);var P=A.lwCalendar.groups=M.extend({selector_key:"groups",id_prefix:"lw_cal_group_",wrapper_id:"lw_cal_group_selector",render:function(){var e,t;if(C.modular&&C.show_categories){e=I("#lw_cal_group_selector");if(e.length&&A.calendar.groups){t=M.template(I("#lw_cal_group_selector_template",U).html());e.replaceWith(t({groups:A.calendar.groups}))}}},selectorInit:function(){var a=this;this.$lis=this.$ul.children();this.group_cnt=this.$lis.length;this.$el.on("click",".select",function(e){var t=I(this);e.preventDefault();if(t.hasClass("all")){a.$lis.not(".selected").each(function(){a.selectItem(I(this))})}else{a.$lis.filter(".selected").each(function(){a.deselectItem(I(this))})}u.load();return true})},select:function(e){var t=I(e.currentTarget).closest("li");if(!I(e.target).is("input[type=checkbox]")){return true}if(t.hasClass("selected")){this.deselectItem(t)}else{this.selectItem(t)}I(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(u.getView()===C.event_view_name){u.setVar("view","all");u.clearVar("event_id")}u.load();return true},markAllSelected:function(){this.$ul.children().addClass("selected").find("input:checkbox").prop("checked",true)},markAllDeselected:function(){this.$ul.children().removeClass("selected").find("input:checkbox").prop("checked",false)},selectItem:function(e){if(e.hasClass("selected"))return;e.addClass("selected").find("input").prop("checked",true);var t=this.$lis.filter(".selected").length;if(t!==1&&t===this.group_cnt){u.clearVar("groups")}else{this.addItem(e.find("input").val())}},deselectItem:function(e){var t=this;if(!e.hasClass("selected"))return;e.removeClass("selected").find("input").prop("checked",false);var a=this.$lis.filter(".selected").length;if(a!==0&&a===this.group_cnt-1){this.$lis.filter(".selected").each(function(){t.addItem(I(this).find("input").val())})}else{this.removeItem(e.find("input").val())}},highlightSelected:function(){var i=u.getValue(this.selector_key);this.$ul.children().removeClass("selected").find("input:checkbox").prop("checked",false);if(i&&i.length){this.$ul.children().each(function(e,t){var a=I(t);if(I.isArray(i)&&-1!==I.inArray(I.trim(a.find("input[type=checkbox]").val()),i)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}})}return true}},S);var N=A.lwCalendar.onlineFilter=M.extend({selector_key:"only_online",id_prefix:"lw_cal_online_",wrapper_id:"lw_cal_online_selector",render:function(){var e=I("#lw_cal_online_selector");var t;if(e.length){t=M.template(I("#lw_cal_online_selector_template",U).html());e.replaceWith(t())}},selectorInit:I.noop,select:function(e){var t=I(e.currentTarget),a=I(e.currentTarget).closest("li");var i=t.prop("checked");if(i){u.setVar(this.selector_key,"true")}else{u.clearVar(this.selector_key)}I(".lw_cal_selector .lw_skip_link").remove();a.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(u.getView()===C.event_view_name){u.setVar("view","all");u.clearVar("event_id")}u.load();return true},highlightSelected:function(){var e=u.getValue(this.selector_key);var t=e.length&&e[0]?true:false;var a=this.$el.find(":checkbox");if(t!==a.prop("checked")){a.prop("checked",t)}return true}},S);var q=A.lwCalendar.calendars={init:function(){var e,t;if(C.modular&&C.show_categories){e=I("#lw_cal_calendar_selector");if(e.length&&!M.isEmpty(A.calendar.calendars)){t=M.template(I("#lw_cal_calendar_selector_template",U).html());e.replaceWith(t({calendars:A.calendar.calendars}))}}}};var B=A.lwCalendar.loginLink={init:function(){var e,t;if(C.modular){e=I("#lw_cal_login_link");if(e.length){t=M.template(I("#lw_cal_login_link_template",U).html());e.replaceWith(t({livewhale:A}))}}}};if(I(".lw_msg_failure").length&&window.innerWidth&&window.innerWidth<=480){I(".lw_msg_failure").remove()}function J(){x.init();Y.init();R.init();H.init();F.init();P.init();q.init();N.init();W.init();V.init();T.init();B.init();u.init()}z.trigger("calBeforeInit.lwcal");J()})(typeof livewhale!=="undefined"&&livewhale.jQuery?livewhale.jQuery:jQuery,window._);